/*! For license information please see bundle.js.LICENSE.txt */
!function(){var e={61:function(e,t,r){var n=r(698).default;function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function p(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(e){p=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,o=Object.create(a.prototype),s=new T(n||[]);return i(o,"_invoke",{value:S(e,r,s)}),o}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var h={};function v(){}function m(){}function g(){}var y={};p(y,c,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(D([])));w&&w!==r&&o.call(w,c)&&(y=w);var x=g.prototype=v.prototype=Object.create(y);function k(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function r(a,i,s,c){var u=f(e[a],e,i);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==n(p)&&o.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(p).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(o,o):o()}})}function S(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return{value:void 0,done:!0}}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var s=I(i,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=f(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function I(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,I(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var a=f(n,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function D(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return m.prototype=g,i(x,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:m,configurable:!0}),m.displayName=p(g,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,p(e,l,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},k(_.prototype),p(_.prototype,u,(function(){return this})),t.AsyncIterator=_,t.async=function(e,r,n,a,o){void 0===o&&(o=Promise);var i=new _(d(e,r,n,a),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(x),p(x,l,"Generator"),p(x,c,(function(){return this})),p(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=D,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;L(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},687:function(e,t,r){var n=r(61)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";function e(e,t,r,n,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,a)}function t(t){return function(){var r=this,n=arguments;return new Promise((function(a,o){var i=t.apply(r,n);function s(t){e(i,a,o,s,c,"next",t)}function c(t){e(i,a,o,s,c,"throw",t)}s(void 0)}))}}var n=r(687),a=r.n(n);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function u(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var l=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!e)return"";var n=e.indexOf(t);if(n<0)return e;for(;e.indexOf(t)>=0;){var a=e.indexOf(t);e=(a>0?e.substring(0,a):"")+r+e.substring(a+t.length)}return e},p=function(e){if(!e||"string"!=typeof e)return e;var t={"İ":"i",I:"ı","Ş":"ş","Ğ":"ğ","Ü":"ü","Ö":"ö","Ç":"ç"};return e.replace(/(([İIŞĞÜÇÖ]))/g,(function(e){return t[e]})).toLowerCase()},d="undefined"==typeof window||window.location.href.includes("staging.vivense"),f=d?"https://ndvivense.glov.ai/treatments_staging.json":"https://ndvivense.glov.ai/treatments.json",h=d?"https://ndvivense.glov.ai/weights_staging.json":"https://ndvivense.glov.ai/weights.json",v=d?"https://ndvivense.glov.ai/nd-styles_staging.css":"https://ndvivense.glov.ai/nd-styles.css?id=".concat(l((new Date).toISOString().substring(0,13).replace("T",""),"-","")),m=d?"https://ndvivense.glov.ai/eligibility_rules_staging.json":"https://ndvivense.glov.ai/eligibility_rules.json",g="https://europe-west3-nextday-34eb3.cloudfunctions.net/api/log",y="(max-width: 440px)",b=15e3,w="BG_SessionTimestamp",x="BG_SessionHistory",k="BG_PopupDisplayFlag",_="BG_TimeoutCount",S="BG_SessionReferrer",I="BG_Weights",A="BG_E_Rules",L="BG_Debug",T="BG_OutOfScope",D="BG_LabelSent",P="BG_UserId_00",E="GLV_IsAdmin",O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Beagle Client SDK",r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i(this,e),this.origin=t,this.DEBUG=r?1:window.localStorage.getItem(L)}return u(e,[{key:"info",value:function(){for(var e,t=this.origin,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];(e=console).info.apply(e,["[".concat(t,"]")].concat(n))}},{key:"log",value:function(){var e=this.DEBUG,t=this.origin;if(e){for(var r,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];(r=console).log.apply(r,["[".concat(t,"]")].concat(a))}}},{key:"failed",value:function(){var e,t=this.DEBUG,r=this.origin;if(t){for(var n="%c%s   ",a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];i.forEach((function(e){switch(o(e)){case"bigint":case"number":case"boolean":n+="%d   ";break;case"string":n+="%s   ";break;default:n+="%o   "}})),(e=console).log.apply(e,[n,"color: red","[".concat(r,"]")].concat(i))}}},{key:"success",value:function(){var e,t=this.DEBUG,r=this.origin;if(t){for(var n="%c%s   ",a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];i.forEach((function(e){switch(o(e)){case"bigint":case"number":case"boolean":n+="%d   ";break;case"string":n+="%s   ";break;default:n+="%o   "}})),(e=console).log.apply(e,[n,"color: green","[".concat(r,"]")].concat(i))}}},{key:"warn",value:function(){for(var e,t=this.origin,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];(e=console).warn.apply(e,["[".concat(t,"]")].concat(n))}},{key:"error",value:function(){for(var e,t=this.origin,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];(e=console).error.apply(e,["[".concat(t,"]")].concat(n))}}]),e}(),C=O;function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){if(e){if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(e,t):void 0}}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,i,s=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t,r){return(t=s(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Q(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Q(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){B(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V=new C("BeagleUtils"),U={ocak:0,"şubat":1,mart:2,nisan:3,"mayıs":4,haziran:5,temmuz:6,"ağustos":7,"eylül":8,ekim:9,"kasım":10,"aralık":11},W=function(){window.top.document.documentElement.classList.remove("glov-ease"),window.top.document.documentElement.classList.remove("glov-hide")},H=function(){var e=t(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=document.createElement("style")).textContent=".glov-ease {\n    -webkit-animation: smooth 2s ease-in;\n    -moz-animation: smooth 2s ease-in;\n    -o-animation: smooth 2s ease-in;\n    -ms-animation: smooth 2s ease-in;\n    animation: smooth 2s ease-in;\n  }\n  \n  @keyframes smooth {\n    0% { opacity: 0;}\n    25% { opacity: 0.25;}\n    50% { opacity: 0.5;}\n    75% { opacity: 0.75;}\n    100% { opacity: 1;}\n  }\n  @-webkit-keyframes smooth {\n    0% { opacity: 0;}\n    25% { opacity: 0.25;}\n    50% { opacity: 0.5;}\n    75% { opacity: 0.75;}\n    100% { opacity: 1;}\n  }",window.top.document.documentElement.prepend(t),window.top.document.documentElement.classList.add("glov-ease"),window.top.document.documentElement.classList.remove("glov-hide");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=t(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,V.log("Fetching treatments"),e.next=4,Z(f);case 4:if(t=e.sent){e.next=7;break}throw new Error;case 7:return e.next=9,t.json();case 9:return r=e.sent,e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),V.failed("Could not fetch treatments",e.t0.message),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=t(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,V.log("Fetching treatment weights"),e.next=4,Z(h);case 4:if(t=e.sent){e.next=7;break}throw new Error;case 7:return e.next=9,t.json();case 9:return r=e.sent,e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),V.failed("Could not fetch treatment weights",e.t0.message),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=t(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,V.log("Fetching eligibility rules"),e.next=4,Z(m);case 4:if(t=e.sent){e.next=7;break}throw new Error;case 7:return e.next=9,t.json();case 9:return r=e.sent,e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),V.failed("Could not fetch eligibility rules",e.t0.message),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=t(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,V.log("Fetching product info"),e.next=4,Z("https://ndvivense.glov.ai/social-proof.txt");case 4:if(t=e.sent){e.next=7;break}throw new Error;case 7:return e.next=9,t.text();case 9:return r=e.sent,e.abrupt("return",fe(r));case 13:return e.prev=13,e.t0=e.catch(0),V.failed("Could not fetch product info",e.t0.message),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),X=function(e){var t=new AbortController;return setTimeout((function(){return t.abort()}),e),t},Z=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return fetch(t,F(F({},r),{},{signal:X(5e3).signal})).then((function(a){if(a.ok)return a;if(n>0)return e(t,r,n-1);throw new Error(a.status)})).catch((function(a){return n>0?(V.failed("Fetch timed out Retrying...: ",a.message),e(t,r,n-1)):(V.failed("Fetch failed: ",a.message),null)}))},ee=function(){var e=t(a().mark((function e(t){var r,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t){e.next=3;break}return e.abrupt("return",null);case 3:if(null!==(r=se(t))){e.next=6;break}return e.abrupt("return",null);case 6:if(!((n=r%100)>=0&&n<100)){e.next=9;break}return e.abrupt("return",n);case 9:return e.abrupt("return",null);case 12:return e.prev=12,e.t0=e.catch(0),V.error(e.t0),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),te=function(e,t){V.log("Applying style changes",t,"to elements",e);for(var r=0;r<e.length;r++)for(var n=e[r],a=0,o=Object.entries(t);a<o.length;a++){var i=N(o[a],2),s=i[0],c=i[1];n.style[s]=c}},re=function(){var e=t(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=window.top.document.createElement("link")).rel="stylesheet",t.type="text/css",t.href=v,window.top.document.head.appendChild(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=t(a().mark((function e(t,r,n,o,i){var s,c,u,l,p,d,f,h,v,m,g,y,b,w,x,k,_,S,I,A,L,T,D;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=JSON.parse(JSON.stringify(r)),c=null,u=G(s),e.prev=3,u.s();case 5:if((l=u.n()).done){e.next=65;break}if(p=l.value,d=p.businessRuleTransformations,f=p.variants,d||f){e.next=10;break}return e.abrupt("continue",63);case 10:if(null!==n&&d){h=G(d);try{for(h.s();!(v=h.n()).done;)if((m=v.value).id===n)for(g in m)"id"!==g&&(p[g]=m[g])}catch(e){h.e(e)}finally{h.f()}}if(!f){e.next=63;break}y=G(Object.keys(f).entries()),e.prev=13,y.s();case 15:if((b=y.n()).done){e.next=55;break}return w=N(b.value,2),x=w[0],k=w[1],o&&(i?p.variants[k].weight=i===k?100:0:p.variants[k].weight||(p.variants[k].weight=Math.floor(100/Object.keys(f).length)*(x+1))),e.next=20,ee(t+k);case 20:if(!(e.sent<p.variants[k].weight)){e.next=53;break}if(c=k,null===n||!f[k].businessRuleTransformations){e.next=51;break}_=G(f[k].businessRuleTransformations),e.prev=25,_.s();case 27:if((S=_.n()).done){e.next=41;break}if((I=S.value).id!=n){e.next=39;break}A=0,L=Object.keys(I);case 31:if(!(A<L.length)){e.next=39;break}if("id"!==(T=L[A])){e.next=35;break}return e.abrupt("continue",36);case 35:p[T]=I[T];case 36:A++,e.next=31;break;case 39:e.next=27;break;case 41:e.next=46;break;case 43:e.prev=43,e.t0=e.catch(25),_.e(e.t0);case 46:return e.prev=46,_.f(),e.finish(46);case 49:e.next=52;break;case 51:for(D in f[k])"weight"!==D&&"businessRuleTransformations"!==D&&(p[D]=f[k][D]);case 52:return e.abrupt("break",55);case 53:e.next=15;break;case 55:e.next=60;break;case 57:e.prev=57,e.t1=e.catch(13),y.e(e.t1);case 60:return e.prev=60,y.f(),e.finish(60);case 63:e.next=5;break;case 65:e.next=70;break;case 67:e.prev=67,e.t2=e.catch(3),u.e(e.t2);case 70:return e.prev=70,u.f(),e.finish(70);case 73:return e.abrupt("return",[s,c]);case 74:case"end":return e.stop()}}),e,null,[[3,67,70,73],[13,57,60,63],[25,43,46,49]])})));return function(t,r,n,a,o){return e.apply(this,arguments)}}(),ae=function(e,t,r){if("notExist"===t)return e?(V.failed("conditionChecker: -not satisfied- target does exist"),!1):(V.success("conditionChecker: -satisfied- target does not exist"),!0);if(null==e||null==t)return V.failed("conditionChecker: runTimeValue or condition is not defined"),!1;switch(t){case"exist":return e?(V.success("conditionChecker: -satisfied- target does exist"),!0):(V.failed("conditionChecker: -not satisfied- target does not exist"),!1);case"includes":case"contains":return e.includes(r)?(V.success("conditionChecker: -satisfied- target contains value"),!0):(V.failed("conditionChecker: -not satisfied- target does not contain value"),!1);case"notIncludes":case"notContains":return e.includes(r)?(V.failed("conditionChecker: -not satisfied- target contains value"),!1):(V.success("conditionChecker: -satisfied- target does not contain value"),!0);case"equal":return e===r?(V.success("conditionChecker: -satisfied- target equals value"),!0):(V.failed("conditionChecker: -not satisfied- target does not equal value"),!1);case"notEqual":return e!==r?(V.success("conditionChecker: -satisfied- target does not equal value"),!0):(V.failed("conditionChecker: -not satisfied- target equals value"),!1);case"greaterThan":return e>r?(V.success("conditionChecker: -satisfied- target is greater than value"),!0):(V.failed("conditionChecker: -not satisfied- target is not greater than value"),!1);case"lessThan":return e<r?(V.success("conditionChecker: -satisfied- target is less than value"),!0):(V.failed("conditionChecker: -not satisfied- target is not less than value"),!1);case"greaterEquals":return e>=r?(V.success("conditionChecker: -satisfied- target is greater or equal than value"),!0):(V.failed("conditionChecker: -not satisfied- target is not greater or equal than value"),!1);case"lessEquals":return e<=r?(V.success("conditionChecker: -satisfied- target is less or equal than value"),!0):(V.failed("conditionChecker: -not satisfied- target is not less or equal than value"),!1);case"between":var n=N(r.split(","),2),a=n[0],o=n[1];return a=parseInt(a),o=parseInt(o),e>=a&&e<=o?(V.success("conditionChecker: -satisfied- target is between min and max"),!0):(V.failed("conditionChecker: -not satisfied- target is not between min and max"),!1);case"regex":return new RegExp(r,"i").test(e);default:return V.failed("conditionChecker: condition is not defined ",t),!1}},oe=function(e){var t=L,r=T,n=window.location.search;if(n.includes("nd_debug=")&&window.localStorage.setItem(r,e),n.includes("nd_debug=1"))return window.localStorage.setItem(t,1),Re("dbm","on"),1;if(n.includes("nd_debug=2"))return window.localStorage.setItem(t,2),Re("dbm","on"),2;if(n.includes("nd_debug=0"))return window.localStorage.removeItem(t),Re("dbm","off"),0;var a=parseInt(window.localStorage.getItem(t));return Re("dbm",a?"on":"off"),a||0},ie=function(){var e=window.ga;if(e&&e.getAll){var t=e.getAll();if(t&&t.length)return t[0].get("clientId")}return null},se=function(e){var t=0;if(0===e.length)return null;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return Math.abs(t)},ce=function(){return new Promise((function(e){try{var t=window.localStorage.getItem(P);if(null!=t)return V.log("getIdentifier: got identifier from local storage",t),void e(t);if(null!=(t=ie()))return V.log("getIdentifier: got identifier from ga in first attempt",t),window.localStorage.setItem(P,t),void e(t);var r=setInterval((function(){null!=(t=ie())&&(V.log("getIdentifier: got identifier from ga",t),clearInterval(r),window.localStorage.setItem(P,t),e(t))}),25);setTimeout((function(){clearInterval(r),null==t&&(V.failed("Could not read GA client id"),e(null))}),5e3)}catch(t){V.failed("Error in getIdentifier",t),e(null)}}))},ue=function(e){return new Promise((function(t){return setTimeout(t,e)}))},le=function(){var e=t(a().mark((function e(t,r){var n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=function(){clearTimeout(n),n=setTimeout(r,t)},n=setTimeout(r,t),window.top.document.ontouchstart=o;case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),pe=function(){var e=navigator.userAgent;return e.match(/chrome|chromium|crios/i)?"chrome":e.match(/firefox|fxios/i)?"firefox":e.match(/safari/i)?"safari":e.match(/opr\//i)?"opera":e.match(/edg/i)?"edge":null},de=function(e){return[].concat(M(Array.from(e[0].addedNodes)),M(Array.from(e[0].removedNodes))).some((function(e){return e.tagName&&Array.from(e.classList).some((function(e){return e.includes("bn-")}))}))};function fe(e,t){t=t||",";for(var r=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),n=[[]],a=null;a=r.exec(e);){var o=a[1];o.length&&o!==t&&n.push([]);var i;i=a[2]?a[2].replace(new RegExp('""',"g"),'"'):a[3],n[n.length-1].push(i)}return n}var he="beagle",ve={name:"data",indexes:[{name:"ix_dataName",fields:["data_name"]},{name:"ix_dataName_session",fields:["data_name","session_id"]},{name:"ix_dataName_dataValue",fields:["data_name","data_value"]},{name:"ix_dataName_dataValue_session",fields:["data_name","data_value","session_id"]}],options:{keyPath:"id",autoIncrement:!0}};function me(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ge(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ye=new C("BeagleDataCollectionWrapper"),be="alltime",we="session",xe=function(){function e(){i(this,e),this.indexedDB=null;try{this.init()}catch(e){ye.failed("Failed to initialized db with: ",e.message)}}var r,n,o,s,c;return u(e,[{key:"init",value:function(){var e,t=this;ye.log("Initializing indexedDB");var r=null===(e=window.top.indexedDB)||void 0===e?void 0:e.open(he);if(!r)throw new Error("indexeddb is not supported");r.onupgradeneeded=function(e){if(0===e.oldVersion);else try{r.result.deleteObjectStore(ve.name)}catch(e){ye.failed("Could not delete outdated database",e.message)}try{var t,n=r.result.createObjectStore(ve.name,ve.options);if((null===(t=ve.indexes)||void 0===t?void 0:t.length)>0){var a,o=me(ve.indexes);try{for(o.s();!(a=o.n()).done;){var i=a.value;n.createIndex(i.name,i.fields)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){ye.failed("Could not create object store on database",e.message)}},r.onerror=function(){throw new Error("Error initializing beagle indexed DB",r.error)},r.onsuccess=function(){var e=r.result;1!==e.version?window.indexedDB.deleteDatabase(he).onsuccess=function(){t.init()}:t.indexedDB=e}}},{key:"getConnection",value:function(){var e=this;return new Promise((function(t,r){var n=setInterval((function(){e.indexedDB&&(clearInterval(n),t())}),25);setTimeout((function(){e.indexedDB||(clearInterval(n),r(new Error("IndexedDB not initialized within the allotted time")))}),5e3)}))}},{key:"initTransaction",value:(c=t(a().mark((function e(){var t,r,n,o=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],e.next=3,this.getConnection();case 3:return r=this.indexedDB.transaction(ve.name,t?"readwrite":"readonly"),n=r.objectStore(ve.name),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"save",value:(s=t(a().mark((function e(t,r){var n,o,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initTransaction(!0);case 2:n=e.sent,o=this.getCurrentSessionId(),i=Math.round(Date.now()/1e3),s={data_name:t,data_value:r,session_id:o,time:i},n.put(s);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"minmax",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:be;return new Promise((function(a){r.initTransaction().then((function(o){var i=void 0;r.getCursor(o,e,n).onsuccess=function(r){var n=r.target.result;if(n){var o=n.value;"data_value"in o?(void 0===i||"min"===t&&o.data_value<i||"max"===t&&o.data_value>i)&&(i=o.data_value):console.warn("key not found in cursor values "+e),n.continue()}else a(i)}}))}))}},{key:"min",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return this.minmax(e,"min",t)}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return this.minmax(e,"max",t)}},{key:"groupBy",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return new Promise((function(n){t.initTransaction().then((function(a){var o=new Map;t.getCursor(a,e,r).onsuccess=function(t){var r=t.target.result;if(r){var a=r.value;"data_value"in a?(o.has(a.data_value)||o.set(a.data_value,0),o.set(a.data_value,o.get(a.data_value)+1)):console.warn("key not found in cursor values "+e),r.continue()}else n(o)}}))}))}},{key:"mode",value:(o=t(a().mark((function e(t){var r,n,o,i,s,c,u,l,p=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.length>1&&void 0!==p[1]?p[1]:be,e.next=3,this.groupBy(t,r);case 3:if(0!==(n=e.sent).keys().length){e.next=6;break}return e.abrupt("return",null);case 6:o={name:void 0,value:-1},i=me(n);try{for(i.s();!(s=i.n()).done;)c=N(s.value,2),u=c[0],l=c[1],o.value<l&&(o.name=u,o.value=l)}catch(e){i.e(e)}finally{i.f()}return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"count",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;return new Promise((function(n){t.initTransaction().then((function(a){var o=0;t.getCursor(a,e,r).onsuccess=function(e){var t=e.target.result;t?(o++,t.continue()):n(o)}}))}))}},{key:"sum",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"alltime";return new Promise((function(n){t.initTransaction().then((function(a){var o=0;t.getCursor(a,e,r).onsuccess=function(t){var r=t.target.result;if(r){var a=r.value;"data_value"in a?o+=parseFloat(a.data_value):console.warn("key not found in cursor values "+e),r.continue()}else n(o.toFixed(2))}}))}))}},{key:"getCursor",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:be,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(n)return r===we?e.index("ix_dataName_dataValue_session").openCursor(IDBKeyRange.only([t,n,this.getCurrentSessionId().toString()])):e.index("ix_dataName_dataValue").openCursor(IDBKeyRange.only([t,n]));if(r===we)return e.index("ix_dataName_session").openCursor(IDBKeyRange.only([t,this.getCurrentSessionId().toString()]));var a="safari"===pe()?t:[t];return e.index("ix_dataName").openCursor(IDBKeyRange.only(a))}},{key:"avg",value:(n=t(a().mark((function e(t){var r,n,o,i=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:be,e.next=3,this.sum(t,r);case 3:return n=e.sent,e.next=6,this.count(t,r);case 6:if(o=e.sent,n&&o){e.next=9;break}return e.abrupt("return",0);case 9:return e.abrupt("return",(n/o).toFixed(2));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"last",value:(r=t(a().mark((function e(t){var r,n,o=this,i=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:1,n=i.length>2&&void 0!==i[2]?i[2]:be,e.abrupt("return",new Promise((function(e){o.initTransaction().then((function(a){var i=a.index("ix_dataName").openCursor([t],"prev");n===we&&(i=a.index("ix_dataName_session").openCursor([t,o.getCurrentSessionId()],"prev"));var s=0,c=[];i.onsuccess=function(t){var n=t.target.result;n&&s<r?(s++,c.push(n.value),n.continue()):e(c)}}))})));case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"getCurrentSessionId",value:function(){var e=new Date;return e.setHours(e.getHours()-2),e.getFullYear()+"-"+(e.getMonth()+1).toString().padStart(2,"0")+"-"+e.getDate().toString().padStart(2,"0")}}]),e}();function ke(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return _e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_e(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Se=new C("BeagleDataCollection"),Ie=new xe,Ae=function(){var e=t(a().mark((function e(t,r,n){var o,i,s,c,u,l,p,d,f,h,v,m,g;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Se.log("queryInCollector",t,r,n),Ie){e.next=4;break}return Se.failed("IndexedDB no supported/Initialized"),e.abrupt("return",null);case 4:if("min"!==r){e.next=11;break}return e.next=7,Ie.min(t,n);case 7:return o=e.sent,e.abrupt("return",o);case 11:if("max"!==r){e.next=18;break}return e.next=14,Ie.max(t,n);case 14:return i=e.sent,e.abrupt("return",i);case 18:if("avg"!==r){e.next=25;break}return e.next=21,Ie.avg(t,n);case 21:return s=e.sent,e.abrupt("return",s);case 25:if("cd"!==r){e.next=31;break}return e.next=28,Ie.groupBy(t,n);case 28:return e.abrupt("return",e.sent.size);case 31:if("cv"!==r){e.next=39;break}return e.next=34,Ie.groupBy(t,n);case 34:c=e.sent,u=0,l=ke(c);try{for(l.s();!(p=l.n()).done;)d=N(p.value,2),f=d[1],u+=f}catch(e){l.e(e)}finally{l.f()}return e.abrupt("return",u);case 39:if("mode"!==r){e.next=46;break}return e.next=42,Ie.mode(t,n);case 42:if(h=e.sent){e.next=45;break}return e.abrupt("return",null);case 45:return e.abrupt("return",h.name);case 46:if(!(r.indexOf("last")>=0)){e.next=55;break}if((v=r.match("last\\(([\\d]+)\\)"))&&2!==!v.length&&!(parseInt(v[1])<1)){e.next=50;break}return e.abrupt("return",null);case 50:return e.next=52,Ie.last(t,v[1],n);case 52:return m=e.sent,g=m.map((function(e){return e.data_value})),e.abrupt("return",g);case 55:return Se.failed("unknown queryMethod=".concat(r," in BeagleDataCollection")),e.abrupt("return",null);case 57:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),Le=function(){var e=t(a().mark((function e(t,r,n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Se.log("updateInCollector",t,r,n),Ie){e.next=4;break}return Se.failed("IndexedDB no supported/Initialized"),e.abrupt("return",null);case 4:return e.next=6,Ie.save(t,r);case 6:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();function Te(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return De(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?De(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}window.beagleInfoLayer=window.beagleInfoLayer||{a:{},e:{},f:{},__hwm:0};var Pe=new C("BeagleInfoLayer"),Ee=[{PageTypeDepend:"*",method:"GADataLayer",selector:"PageType",name:"PageType"},{PageTypeDepend:"*",method:"GADataLayer",selector:"isAdmin",name:"vvsIsShowroom"},{PageTypeDepend:"*",method:"GADataLayer",selector:"userId",name:"vvsUserId"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"content_name",name:"pdp.name"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"productgroup",name:"pdp.group"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"vivense_category",name:"pdp.class"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"content_ids",name:"pdp.sku",formatter:"upperCaseTR"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"ProductID",name:"pdp.sku"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"content_category",name:"pdp.category"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"ecommerce.detail.actionField.list",name:"pdp.listalias"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"vivenseProducts.*.sku",name:"pdp.sku",formatter:"dearray"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"vivenseProducts.*.category",name:"pdp.category",formatter:"dearray"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"vivenseProducts.*.discountRate",name:"pdp.discountRate",formatter:"dearray"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"vivenseProducts.*.fastDelivery",name:"pdp.fastDelivery",formatter:"dearray"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"vivenseProducts.*.isInShowroom",name:"pdp.isInShowroom",formatter:"dearray"},{PageTypeDepend:"Productpage",method:"GADataLayer",selector:"vivenseProducts.*.price",name:"pdp.price",formatter:"dearray"},{PageTypeDepend:"Listingpage",method:"GADataLayer",selector:"search_success",name:"plp.searchSuccess",exclusive:["plp.id","plp.approximateCount","plp.name","plp.group","plp.class"]},{PageTypeDepend:"Listingpage",method:"GADataLayer",selector:"content_ids",name:"plp.id",exclusive:["plp.searchSuccess"]},{PageTypeDepend:"Listingpage",method:"GADataLayer",selector:"category_product_count",name:"plp.approximateCount",exclusive:["plp.searchSuccess"]},{PageTypeDepend:"Listingpage",method:"GADataLayer",selector:"content_name",name:"plp.name",exclusive:["plp.searchSuccess"]},{PageTypeDepend:"Listingpage",method:"GADataLayer",selector:"productgroup",name:"plp.group",exclusive:["plp.searchSuccess"]},{PageTypeDepend:"Listingpage",method:"GADataLayer",selector:"vivense_category",name:"plp.class",exclusive:["plp.searchSuccess"]},{PageTypeDepend:"purchase",method:"GADataLayer",selector:"ecommerce.purchase.products.*.id",name:"purchase.skus"},{PageTypeDepend:"purchase",method:"GADataLayer",selector:"ecommerce.purchase.products.*.price",name:"purchase.prices"},{PageTypeDepend:"purchase",method:"GADataLayer",selector:"ecommerce.purchase.products.*.quantity",name:"purchase.quantities"},{PageTypeDepend:"purchase",method:"GADataLayer",selector:"ecommerce.purchase.products.*.category",name:"purchase.categories"},{PageTypeDepend:"purchase",method:"GADataLayer",selector:"ecommerce.purchase.actionField.id",name:"purchase.orderId"},{PageTypeDepend:"purchase",method:"GADataLayer",selector:"ecommerce.purchase.actionField.revenue",name:"purchase.revenue"},{PageTypeDepend:"purchase",method:"GADataLayer",selector:"ecommerce.purchase.actionField.dimension15",name:"purchase.paymentType"},{PageTypeDepend:"*",method:"DocQuery",selector:'[class*="page_preview_wrapper_production"]',name:"PageType",operand:"docQueryValueIfHasInnerText",value:"Homepage"},{PageTypeDepend:"*",method:"DocQuery",selector:'[class*="category_page_wrapper"]',name:"PageType",operand:"docQueryValueIfHasInnerText",value:"Listingpage"},{PageTypeDepend:"*",method:"DocQuery",selector:'[class*="product-main-details"]',name:"PageType",operand:"docQueryValueIfHasInnerText",value:"Productpage"},{PageTypeDepend:"*",method:"DocQuery",selector:'[class*="product"]',name:"PageType",operand:"docQueryValueIfHasInnerText",value:"Productpage"},{PageTypeDepend:"Homepage|Productpage|Listingpage",method:"DocQuery",selector:'[class*="welcome_username"]',name:"view.isLoggedIn",operand:"docQueryHasInnerText"},{PageTypeDepend:"Homepage|Productpage|Listingpage",method:"DocQuery",selector:'[class*="empty_basket_text"]',name:"cart.isempty",operand:"docQueryHasInnerText",exclusive:["cart.totalBasePrice","cart.skucount","cart.couponNotApplicable"]},{PageTypeDepend:"Homepage|Productpage|Listingpage",method:"DocQuery",selector:"body > .desktop_layout_wrapper .not-allowed-coupon",name:"cart.couponNotApplicable",operand:"docQuerySumNumInnerText",exclusive:["cart.isempty"]},{PageTypeDepend:"Homepage|Productpage|Listingpage",method:"DocQuery",selector:'[class*="basket_total_price"]',name:"cart.totalBasePrice",operand:"docQueryInnerText",exclusive:["cart.isempty","cart.couponNotApplicable"],formatter:"numericOnly"},{PageTypeDepend:"Homepage|Productpage|Listingpage",method:"DocQuery",selector:'[id*="cart_quantity"], [class*="basket_length"]',name:"cart.skucount",operand:"docQueryInnerText",exclusive:["cart.isempty"]},{PageTypeDepend:"Productpage",method:"DocQuery",selector:'[class*="delivery-date"]',name:"pdp.deliveryDate",operand:"docQueryInnerText"},{PageTypeDepend:"Productpage",method:"DocQuery",selector:'[class*="delivery-date"]',name:"pdp.deliveryDateFormatted",operand:"docQueryInnerText",formatter:"formatDeliveryDate"},{PageTypeDepend:"Productpage",method:"DocQuery",selector:'[class*="product-title"], [class*="header-bottom"]',name:"pdp.name",operand:"docQueryInnerText"},{PageTypeDepend:"Productpage",method:"DocQuery",selector:'[class*="vivense-showrooms"] > *',name:"pdp.showroomcount",operand:"docQueryCountElts",exclusive:["pdp.hasNoShowrooms"]},{PageTypeDepend:"Productpage",method:"DocQuery",selector:"#vivense-showroom-tab p:not(.vivense-showrooms)",name:"pdp.hasNoShowrooms",operand:"docQueryHasInnerText",exclusive:["pdp.showroomcount"]},{PageTypeDepend:"Listingpage",method:"DocQuery",selector:'[class*="count-of-product"]',name:"plp.itemCount",operand:"docQueryInnerText",formatter:"numericOnly"},{PageTypeDepend:"Listingpage",method:"DocQuery",selector:'[class*="subcategories-title"]',name:"plp.name",operand:"docQueryInnerText"},{PageTypeDepend:"Listingpage",method:"DocQuery",selector:".product-card[data-product-sku]",name:"__features.SKUsonPage",operand:"docQueryAttribValueList",value:"data-product-sku"},{PageTypeDepend:"Listingpage",method:"DocQuery",selector:".product-list",observer:"listingItemBlock",name:"__listingItemBlockObserver",children:["__features.SKUsonPage"],operand:"docQueryObserve"},{PageTypeDepend:"basket",method:"DocQuery",selector:".empty-cart-container, .empty-cart",name:"cart.isempty",operand:"docQueryHasInnerText",exclusive:["cart.skucount","cart.totalPrice","cart.totalPriceFinal","cart.couponNotApplicable","cart.skus","cart.prices","cart.quantities","cart.categories","__checkoutFormObserver"]},{PageTypeDepend:"basket",method:"DocQuery",selector:".bracket-text, .product-count",name:"cart.skucount",operand:"docQueryInnerText",exclusive:["cart.isempty"],formatter:"numericOnly"},{PageTypeDepend:"basket",method:"DocQuery",selector:".cartItemQuantity",name:"cart.quantities",operand:"docQueryAttribValueList",value:"data-previous",exclusive:["cart.isempty"]},{PageTypeDepend:"basket",method:"DocQuery",selector:"#bill_total",name:"cart.totalPrice",operand:"docQueryInnerText",exclusive:["cart.isempty"],formatter:"numericOnly"},{PageTypeDepend:"basket",method:"DocQuery",selector:'[class*="order-final-number"]',name:"cart.totalPriceFinal",operand:"docQueryInnerText",exclusive:["cart.isempty"],formatter:"numericOnly"},{PageTypeDepend:"basket",method:"DocQuery",selector:'[class*="cart-price"] .not-allowed-coupon',name:"cart.couponNotApplicable",operand:"docQuerySumNumInnerText",exclusive:["cart.isempty"]},{PageTypeDepend:"basket",method:"DocQuery",selector:".cart-inside",name:"cart.skus",operand:"docQueryAttribValueList",value:"data-sku",exclusive:["cart.isempty","cart.couponNotApplicable"]},{PageTypeDepend:"basket",method:"DocQuery",selector:".cart-inside",name:"cart.categories",operand:"docQueryAttribValueList",value:"data-last-breadcrumb",exclusive:["cart.isempty","cart.couponNotApplicable"]},{PageTypeDepend:"basket",method:"DocQuery",selector:".cart-inside",name:"cart.prices",operand:"docQueryAttribValueList",value:"data-price",exclusive:["cart.isempty","cart.couponNotApplicable"]},{PageTypeDepend:"basket",method:"DocQuery",selector:".cart-right-container",observer:"checkoutForm",name:"__checkoutFormObserver",children:["cart.skucount","cart.totalPrice","cart.totalPriceFinal","cart.couponNotApplicable","cart.skus","cart.prices","cart.quantities","cart.categories","cart.isempty","cart.couponApplicableAmount"],operand:"docQueryObserve"},{PageTypeDepend:"basket",method:"DocQuery",selector:"#checkoutForm",observer:"checkoutForm",name:"__checkoutFormObserver",children:["cart.skucount","cart.totalPrice","cart.totalPriceFinal","cart.couponNotApplicable","cart.skus","cart.prices","cart.quantities","cart.categories","cart.isempty","cart.couponApplicableAmount"],operand:"docQueryObserve"},{PageTypeDepend:"purchase",method:"DocQuery",selector:'[class*="basket_summary_total"], [class*="total_row"]',name:"purchase.revenue",operand:"docQueryInnerText",formatter:"numericOnly"},{PageTypeDepend:"purchase",method:"DocQuery",selector:'[class*="order_follow_numb"], [class*="cart-title-bottom"]',name:"purchase.vvsTxnId",operand:"docQueryInnerText"},{PageTypeDepend:"purchase",method:"DocQuery",selector:".payment_type_title, .cart-title-info",name:"purchase.paymentType",operand:"docQueryInnerText",formatter:"lowerCaseTRFirstWord"},{PageTypeDepend:"purchase",method:"DocQuery",selector:'[class*="product_sku_code"]',name:"purchase.skus",operand:"docQueryArrayInnerText"},{PageTypeDepend:"purchase",method:"DocQuery",selector:".cart-inside",name:"purchase.skus",operand:"docQueryAttribValueList",value:"data-sku"},{PageTypeDepend:"Productpage",method:"DocSorg",selector:"sku",name:"pdp.sku"},{PageTypeDepend:"Productpage",method:"DocSorg",selector:"mpn",name:"pdp.mpn"},{PageTypeDepend:"Productpage",method:"DocSorg",selector:"name",name:"pdp.name",operand:"JSONFilterOther",value:"@type=Product"},{PageTypeDepend:"Productpage",method:"DocSorg",selector:"offers.price",name:"pdp.price"},{PageTypeDepend:"Productpage",method:"DocSorg",selector:"offers.priceValidUntil",name:"pdp.priceValidUntil"},{PageTypeDepend:"Productpage",method:"DocSorg",selector:"itemListElement.*.name",name:"view.breadcrumb"},{PageTypeDepend:"Listingpage",method:"DocSorg",selector:"mainEntity.name",name:"plp.name"},{PageTypeDepend:"Listingpage",method:"DocSorg",selector:"mainEntity.numberOfItems",name:"plp.itemCount"},{PageTypeDepend:"Listingpage",method:"DocSorg",selector:"breadcrumb.itemListElement.*.item.name",name:"view.breadcrumb"},{PageTypeDepend:"*",method:"SingleWT",selector:"favoriteProducts",name:"view.favoritedMPNs"},{PageTypeDepend:"*",method:"SingleWT",selector:"isAdmin",name:"vvsIsShowroom",formatter:"toString"},{PageTypeDepend:"*",method:"SingleWT",selector:"userId",name:"vvsUserId"}],Oe={view_epoch:[{updateMethod:"min"},{queryMethod:"min",window:"session",featureName:"history.view_epoch_min"}],PageType:[{updateMethod:"count_values"},{queryMethod:"cv",window:"session",featureName:"history.PageType_count_session"},{queryMethod:"cv",window:"alltime",featureName:"history.PageType_count_alltime"}],"cart.couponApplicableAmount":[{updateMethod:"last"},{queryMethod:"last(1)",window:"session",featureName:"__features.lastCartCouponApplicable"}],"pdp.category":[{updateMethod:"count_values"},{updateMethod:"last"},{queryMethod:"mode",window:"session",featureName:"history.pdp_category_mode_session"},{queryMethod:"last(1)",window:"session",featureName:"history.pdp_category_last_session"}],"cart.skus":[{updateMethod:"last"},{queryMethod:"last(1)",window:"session",featureName:"__features.SKUsonLastCartView"}]},Ce=function(){window.top.beagleInfoLayer.__hwm+=1},Re=function(e,t){var r=window.top.beagleInfoLayer;if(null!=e){var n="string"==typeof t?t.toString().trim():t;if(e.indexOf(".")>-1){var a=e.split("."),o=a.pop(),i=r;a.forEach((function(e){i[e]||(i[e]={}),i=i[e]})),i[o]=n}else r[e]=n;Ce(),null!=n&&(We(e,n),Me(e,n))}},je={},Ne=function(e,t){je[e]||(je[e]=[]),je[e].push(t)},Me=function(e,t){var r=je[e];if(r&&Array.isArray(r)&&r.length>0)for(var n=0;n<r.length;n+=1){var a=r[n];"function"==typeof a&&(Pe.log("passValueToListeners --\x3e value ".concat(t," to listener ").concat(n," of key ").concat(e)),a(t))}},Be=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4,a=window.top.beagleInfoLayer;if(!e)return null;var o=Ke(a,e);if(null!=o)return Promise.resolve(o);var i,s=Te(Ee);try{for(s.s();!(i=s.n()).done;){var c=i.value;if(e===c.name&&(c.isFound||c.isIgnore))return Promise.resolve(null)}}catch(e){s.e(e)}finally{s.f()}return t?new Promise((function(t){var i=setInterval((function(){null!=(o=Ke(a,e))&&(clearInterval(i),t(o));var r,n=Te(Ee);try{for(n.s();!(r=n.n()).done;){var s=r.value;e===s.name&&(s.isFound||s.isIgnore)&&(clearInterval(i),t(null))}}catch(e){n.e(e)}finally{n.f()}}),r);setTimeout((function(){clearInterval(i),t(null)}),n)})):Promise.resolve(null)},Ge=function(e){var t=window.top.beagleInfoLayer;if(null!=e){if(e.indexOf(".")>-1){var r=e.split("."),n=r.pop(),a=t;r.forEach((function(e){a[e]&&(a=a[e])})),Pe.log("removeFromBeagleInfoLayer","Removing ".concat(n," from ").concat(JSON.stringify(a))),delete a[n]}else delete t[e];Ce(),We(e,null),Me(e,null)}},Qe=function(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o={},i=window.top.beagleInfoLayer;switch(null!=t&&(o.businessRuleId=t),r&&(o.variant=r),n){case"applied":i.a[e]=o;break;case"skipped":o.dependant_on_treatment=a,i.e[e]=o;break;case"failed":i.f[e]=o}Ce()},qe=10,Fe=0,Ve=function(){var e=t(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ye(),$e(),Xe();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ue=function(){var e=t(a().mark((function e(){var t,r,n,o,i,s,c,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object.keys(Oe),r=0,n=t;case 2:if(!(r<n.length)){e.next=30;break}if(o=n[r],!((i=Oe[o])&&Array.isArray(i)&&i.length>0)){e.next=27;break}s=Te(i),e.prev=7,s.s();case 9:if((c=s.n()).done){e.next=19;break}if(null!==(u=c.value).queryMethod&&void 0!==u.queryMethod){e.next=13;break}return e.abrupt("continue",17);case 13:return e.next=15,Ae(o,u.queryMethod,u.window);case 15:l=e.sent,Re(u.featureName,l);case 17:e.next=9;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(7),s.e(e.t0);case 24:return e.prev=24,s.f(),e.finish(24);case 27:r++,e.next=2;break;case 30:case"end":return e.stop()}}),e,null,[[7,21,24,27]])})));return function(){return e.apply(this,arguments)}}(),We=function(){var e=t(a().mark((function e(t,r){var n,o,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=Oe[t])&&Array.isArray(n)&&n.length>0)){e.next=21;break}o=Te(n),e.prev=3,o.s();case 5:if((i=o.n()).done){e.next=13;break}if(null!==(s=i.value).updateMethod&&void 0!==s.updateMethod){e.next=9;break}return e.abrupt("continue",11);case 9:return e.next=11,Le(t,r,s.updateMethod);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),o.e(e.t0);case 18:return e.prev=18,o.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})));return function(t,r){return e.apply(this,arguments)}}(),He=function(){var e=t(a().mark((function e(){var t,r,n,o,i,s,c,u,l,p,d,f,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be("PageType",!0,50,1e3);case 2:return t=e.sent,e.prev=3,e.next=6,Promise.all([Be("cart.isempty"),Be("cart.totalBasePrice"),Be("cart.couponNotApplicable"),Be("cart.prices"),Be("cart.quantities")]);case 6:if(r=e.sent,n=N(r,5),o=n[0],i=n[1],s=n[2],c=n[3],u=n[4],l=0,!i&&c&&Array.isArray(c)&&c.length>0&&u&&Array.isArray(u)&&u.length>0&&c.length===u.length)for(p=0;p<c.length;p++)l+=parseInt(c[p])*parseInt(u[p]);else l=parseInt(i);0,d=!o&&l&&s?l-parseInt(s):!o&&l?parseInt(l):0,Re("cart.couponApplicableAmount",d),o&&(Re("cart.totalPrice",0),Re("cart.couponNotApplicable",0)),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(3),Pe.error("customDataDerivations cannot compute couponApplicablePrice: "+e.t0);case 24:if("Productpage"!==t){e.next=33;break}return e.next=27,Be("pdp.sku");case 27:if(null==(f=e.sent)){e.next=31;break}return e.next=31,Re("__features.SKUsonPage",[f]);case 31:e.next=40;break;case 33:if("basket"!==t){e.next=40;break}return e.next=36,Be("cart.skus");case 36:if(null===(h=e.sent)||!Array.isArray(h)||!h.length){e.next=40;break}return e.next=40,Re("__features.SKUsonPage",h);case 40:case"end":return e.stop()}}),e,null,[[3,21]])})));return function(){return e.apply(this,arguments)}}(),Je=function(){var e=t(a().mark((function e(){var t,r,n,o,i,s,c,u,l,p,d,f,h,v,m,g,y,b,w,x,k;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.readyState,Pe.log("parseSearchPaths initialized with dom status:  "+t),r=window.top,n=r.dataLayer,o=r.document,s=new Set,c=new Set,u=new Set,e.next=10,Be("PageType");case 10:(l=e.sent)&&c.add("PageType"),p=Te(Ee);try{for(p.s();!(d=p.n()).done;)(f=d.value).isFound&&c.add(f.name)}catch(e){p.e(e)}finally{p.f()}h=Te(Ee),e.prev=15,h.s();case 17:if((v=h.n()).done){e.next=38;break}if(!(m=v.value).isFound&&!m.isIgnore){e.next=21;break}return e.abrupt("continue",36);case 21:if(!s.has(m.name)&&!c.has(m.name)){e.next=24;break}return m.isFound=!0,e.abrupt("continue",36);case 24:if("*"===m.PageTypeDepend){e.next=35;break}if(l){e.next=32;break}return e.next=28,Be("PageType");case 28:if(l=e.sent){e.next=32;break}return u.add(m.name),e.abrupt("continue",36);case 32:if(!(m.PageTypeDepend.indexOf(l)<0)){e.next=35;break}return m.isIgnore=!0,e.abrupt("continue",36);case 35:if("SingleWT"===m.method)ze(r,m,s,u);else if("GADataLayer"===m.method){g=Te(n);try{for(g.s();!(y=g.n()).done;)b=y.value,ze(b,m,s,u)}catch(e){g.e(e)}finally{g.f()}}else if("DocSorg"===m.method){i||(i=Ze()),w=Te(i);try{for(w.s();!(x=w.n()).done;)k=x.value,ze(k,m,s,u)}catch(e){w.e(e)}finally{w.f()}}else"DocQuery"===m.method&&ze(o,m,s,u);case 36:e.next=17;break;case 38:e.next=43;break;case 40:e.prev=40,e.t0=e.catch(15),h.e(e.t0);case 43:return e.prev=43,h.f(),e.finish(43);case 46:0===u.size?(Fe=10,Pe.log("parseSearchPaths found all elements - setting retry to max")):0===s.size?("complete"!==t&&"interactive"!==t||(qe*=2,Fe+=1),Pe.log("parseSearchPaths processed but not found any, setting delay and retry to "+qe+" and "+Fe+" for notfound: ["+Array.from(u).join(" | ")+"]")):Pe.log("parseSearchPaths processed: notfound: ["+Array.from(u).join(" | ")+"] and found "+s.size);case 47:case"end":return e.stop()}}),e,null,[[15,40,43,46]])})));return function(){return e.apply(this,arguments)}}(),ze=function(e,r,n,o){!function(e,r){var n,o;try{switch(r.operand){case"JSONFilterOther":if(null==(n=Ke(e,r.selector)))break;var i=r.value.split("=");if(2!==i.length)break;var s=i[0],c=i[1];if(!s||!c)break;var u=Ke(e,s);if(!u||u!==c)break;n&&(Array.isArray(n)?n.length>0:n.toString().trim().length>0)&&(o=n);break;case"docQueryObserve":if(null!=(n=e.querySelector(r.selector))){r.isFound=!0;var l=[];r.children.forEach((function(e){var t=Ee.filter((function(t){return t.name===e}));l.push.apply(l,M(t))}));var p=new MutationObserver(function(){var e=t(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!de(t)){e.next=2;break}return e.abrupt("return");case 2:l.forEach((function(e){e.isFound=!1,Ge(e.name)})),n=Fe>=10,qe=10,Fe=0,n&&(Pe.log("searchObj: triggered a restart of searchpaths due: ",r.name),$e());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());p.observe(n,{subtree:!0,childList:!0})}break;case"docQueryInnerText":null!=(n=e.querySelector(r.selector))&&n.innerText&&n.innerText.trim().length>0&&(o=n.innerText);break;case"docQueryAttribValueList":var d=[];if(null==(n=e.querySelectorAll(r.selector))||0===n.length)break;var f,h=Te(n);try{for(h.s();!(f=h.n()).done;){var v=f.value.getAttribute(r.value);v&&d.push(v)}}catch(e){h.e(e)}finally{h.f()}d.length>0&&(o=d);break;case"docQueryHasInnerText":null!=(n=e.querySelector(r.selector))&&(o=(n.innerText.trim().length>0).toString());break;case"docQueryCountElts":null!=(n=e.querySelectorAll(r.selector))&&(o=n.length);break;case"docQueryValueIfHasInnerText":(n=e.querySelector(r.selector))&&n.innerText&&n.innerText.trim().length>0&&(o=r.value);break;case"docQuerySumNumInnerText":if(null==(n=e.querySelectorAll(r.selector))||0===n.length)break;var m,g=0,y=Te(n);try{for(y.s();!(m=y.n()).done;){var b=m.value.innerText.trim().replace(/\D/g,"");b.length>0&&(g+=parseInt(b))}}catch(e){y.e(e)}finally{y.f()}g>0&&(o=g);break;case"docQueryArrayInnerText":if(null==(n=e.querySelectorAll(r.selector))||0===n.length)break;var w,x=[],k=Te(n);try{for(k.s();!(w=k.n()).done;){var _=w.value.innerText.trim();_.length>0&&x.push(_)}}catch(e){k.e(e)}finally{k.f()}x.length>0&&(o=x);break;default:null!=(n=Ke(e,r.selector))&&(Array.isArray(n)?n.length>0:n.toString().trim().length>0)&&(o=n)}if(null!=o&&(r.formatter&&(o=function(e,t){if(null==e||!t)return null;switch(t){case"upperCaseTR":return e.toString().toUpperCase("tr-TR");case"formatDeliveryDate":return function(e){if(!e||"string"!=typeof e)return e;var t={startMonthIndex:void 0,endMonthIndex:void 0,startDay:void 0,endDay:void 0},r=e.match("([\\d]+)-([\\d]+)\\s?([\\wıüğşöçİÖÇĞÜŞ]+)");if(r&&4===r.length)t.startDay=parseInt(r[1]),t.endDay=parseInt(r[2]),t.startMonthIndex=U[r[3].toLowerCase()],t.endMonthIndex=t.startMonthIndex;else{if(!(r=e.match("([\\d]+)\\s+([\\wıüğşöçİÖÇĞÜŞ]+)-([\\d]+)\\s+([\\wıüğşöçİÖÇĞÜŞ]+)"))||5!==r.length)return e;t.startDay=parseInt(r[1]),t.startMonthIndex=U[r[2].toLowerCase()],t.endDay=parseInt(r[3]),t.endMonthIndex=U[r[4].toLowerCase()]}try{var n=new Date;if(!t.startMonthIndex||!t.endMonthIndex)return e;var a=t.startMonthIndex>=n.getMonth()?n.getFullYear():n.getFullYear()+1,o=t.endMonthIndex>=n.getMonth()?n.getFullYear():n.getFullYear()+1,i=new Date(a,t.startMonthIndex,t.startDay),s=new Date(o,t.endMonthIndex,t.endDay),c=Math.ceil(Math.abs(i-n)/864e5),u=Math.ceil(Math.abs(s-n)/864e5),l=c<7?0:Math.ceil(c/7),p=u<7?0:Math.ceil(u/7);return 0===l&&0===p?"".concat(c," - ").concat(u," Gün"):0===l&&p>=1?"".concat(c," Gün - ").concat(p," Hafta"):l===p?"".concat(l," Hafta"):"".concat(l," - ").concat(p," Hafta")}catch(t){return e}}(e);case"numericOnly":return e.replace(/\D/g,"");case"lowerCaseTRFirstWord":return e.toString().toLowerCase("tr-TR").split(" ")[0];case"dearray":return Array.isArray(e)&&e.length>0?e[0]:e;case"toString":return e.toString().trim();default:return e}}(o,r.formatter)),Re(r.name,o),r.isFound=!0,r.exclusive&&Array.isArray(r.exclusive)&&r.exclusive.length>0)){var S,I=Te(Ee);try{for(I.s();!(S=I.n()).done;){var A=S.value;r.exclusive.includes(A.name)&&(A.isFound=!0)}}catch(e){I.e(e)}finally{I.f()}}if(r.isFound)return!0}catch(e){Pe.error("searchObj error: "+e)}return!1}(e,r)?o.add(r.name):n.add(r.name)},$e=function(){var e=t(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je();case 2:if(!(Fe<10)){e.next=7;break}Pe.log("parseSearchPaths: scheduled to be recalled in "+qe+"ms"),setTimeout(t(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$e();case 2:case"end":return e.stop()}}),e)}))),qe),e.next=13;break;case 7:return Pe.log("parseSearchPaths: reached max retry, calling remainder historical data"),e.next=10,He();case 10:return e.next=12,Ue();case 12:Re("__CompletedScraping",!0);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ke=function e(t,r){if(!t)return null;if(!r)return null;try{for(var n=r.split("."),a=t,o=0;o<n.length;o++){if(null===a)return null;if("*"===n[o]){var i=n.slice(o+1).join("."),s=[];for(var c in a)if(void 0!==a[c]&&null!==a[c]){var u=e(a[c],i);null!=u&&s.push(u)}return s}a=a[n[o]]}return a}catch(e){return null}},Ye=function(){var e=t(a().mark((function e(){var t,r,n,o,i,s,c,u,l,p,d,f,h,v,m,g,y,b,w,x,k,_,I,A,L,T,D,P,E,O,C,R;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v=window.top,m=v.navigator,g=(null===(t=v.navigator)||void 0===t||null===(r=t.userAgentData)||void 0===r?void 0:r.platform)||(null===(n=v.navigator)||void 0===n?void 0:n.platform)||(null===(o=v.navigator)||void 0===o?void 0:o.userAgent),Re("device.navPlatform",g),Re("device.windowPRatio",v.devicePixelRatio),y=(null===(i=v.screen)||void 0===i?void 0:i.availWidth)+"x"+(null===(s=v.screen)||void 0===s?void 0:s.availHeight),Re("device.windowAvail",y),b=(null===(c=v.screen)||void 0===c?void 0:c.colorDepth)+"-"+(null===(u=v.screen)||void 0===u?void 0:u.pixelDepth),Re("device.windowDepth",b),w=(null===(l=v.visualViewport)||void 0===l?void 0:l.width)+"x"+(null===(p=v.visualViewport)||void 0===p?void 0:p.height),Re("device.windowVport",w),screen.width&&(x=parseInt(screen.width),k=screen.height?parseInt(screen.height):0,0!==x&&0!==k&&(/iPad|iPhone|iPod/.test(g)&&v.devicePixelRatio?(x=Math.round(x*v.devicePixelRatio),k=Math.round(k*v.devicePixelRatio)):(A=null===(_=v.screen)||void 0===_||null===(I=_.orientation)||void 0===I?void 0:I.angle,90!==Math.abs(A)&&270!==Math.abs(A)||(L=x,x=k,k=L)),Re("device.window",x+"x"+k))),Re("device.navHistSize",null===(d=v.history)||void 0===d?void 0:d.length),m.userAgent?Re("device.navAgent",m.userAgent):m.userAgentData&&(E=null==m||null===(T=m.userAgentData)||void 0===T||null===(D=T.brands)||void 0===D?void 0:D.map((function(e){return e.brand+":"+e.version})).join(),E+=null!=m&&null!==(P=m.userAgentData)&&void 0!==P&&P.mobile?"mobi":" ",Re("device.navAgent",E+=g)),Re("device.navHWCores",m.hardwareConcurrency),Re("device.navLanguage",m.language||m.browserLanguage||m.systemLanguage||m.userLanguage),Re("device.navTouch",m.maxTouchPoints),Re("device.navVendor",m.vendor),Re("device.internetSpeed",null===(f=v.navigator)||void 0===f||null===(h=f.connection)||void 0===h?void 0:h.downlink),O=new URL(window.top.location.href),Re("u",O.href),Re("d",O.hostname),Re("donttrack",m.doNotTrack||v.doNotTrack||m.msDoNotTrack),Re("r",v.document.referrer),(C=sessionStorage.getItem(S))?Re("fr",C):(sessionStorage.setItem(S,v.document.referrer),Re("fr",v.document.referrer)),O.pathname.indexOf("favorilerim.html")>-1?R="favorites":O.pathname.indexOf("siparis-listesi.html")>-1?R="basket":O.pathname.indexOf("siparis-ozeti.html")>-1?R="purchase":O.pathname.indexOf("odeme.html")>-1?R="payment":O.pathname.indexOf("adres-listesi.html")>-1?R="address":O.pathname.indexOf("siparislerim.html")>-1?R="pastorders":O.pathname.indexOf("uye-kayit.html")>-1?R="register":O.pathname.indexOf("uye-girisi.html")>-1?R="signin":O.pathname.indexOf("kuponlarim.html")>-1?R="profile_coupons":O.pathname.indexOf("profil-guncelle.html")>-1?R="profile_info":O.pathname.indexOf("adreslerim.html")>-1?R="profile_addresses":O.pathname.indexOf("duyuru-tercihleri.html")>-1?R="profile_notifications":O.pathname.indexOf("indirimli-mobilya-kampanyalari.html")>-1&&(R="special_campaigns"),R&&Re("PageType",R);case 28:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Xe=function(){var e=window.top,t={},r=e.performance.getEntriesByType("navigation")[0];e.performance&&r&&(t.connect=Math.round(r.connectEnd-r.connectStart),t.request=Math.round(r.responseEnd-r.requestStart),t.dom=Math.round(r.domInteractive-r.domComplete),t.load=Math.round(r.loadEventEnd-r.loadEventStart),t.duration=Math.round(r.duration)),Re("metrics",t)},Ze=function(){var e,t=[],r=Te(window.top.document.querySelectorAll('[type="application/ld+json"]'));try{for(r.s();!(e=r.n()).done;){var n=e.value;try{var a=n.textContent,o=JSON.parse(a);t.push(o)}catch(e){}}}catch(e){r.e(e)}finally{r.f()}return t},et=new C("BeagleMonitor"),tt={type:"text/plain"},rt=function(){function e(){i(this,e),et.log("Initializing monitor"),this.hasArrivalLogSent=!1,this.hasMainLogSent=!1,this.hasUpdatesSent=!1,this.highWaterMark=null,this.initializeExitEventListeners()}var r,n,o,s,c,l,p,d,f;return u(e,[{key:"sendLogs",value:(f=t(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return et.log("In immediate sending block"),e.next=4,this.packAndQueueMainLog();case 4:e.next=12;break;case 6:return et.log("In non-critical send path - awaiting scraping"),e.next=9,Be("__CompletedScraping",!0,50,1e3);case 9:return et.log("In non-critical send path - sending logs"),e.next=12,this.packAndQueueMainLog();case 12:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"handleCloseEvent",value:(d=t(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.packAndQueueMainLog();case 2:return e.next=4,this.packAndQueueIncrementalLog();case 4:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"packAndQueueMainLog",value:(p=t(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasMainLogSent){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.packageMainLogData();case 4:if(!(t=e.sent)){e.next=11;break}return e.next=8,this.checkForLatestChanges();case 8:et.log("Request blob to send: ",t),this.hasMainLogSent=!0,this.queueLogs(t);case 11:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"packAndQueueIncrementalLog",value:(l=t(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hasMainLogSent&&!this.hasUpdatesSent){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.checkForLatestChanges();case 4:if(t=e.sent,et.log("Update logs change status: ",t),t){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,this.packageIncrementalLogData();case 10:(r=e.sent)&&(et.log("Sending incremental logs",r),this.hasUpdatesSent=!0,this.queueLogs(r));case 12:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"packAndQueueArrivalLog",value:(c=t(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasMainLogSent&&!this.hasArrivalLogSent){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.packageArrivalLogData();case 4:(t=e.sent)&&(et.log("Arrival blob to send: ",t),this.hasArrivalLogSent=!0,this.queueLogs(t));case 6:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"checkForLatestChanges",value:(s=t(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Be("__hwm");case 2:if(t=e.sent,this.highWaterMark===t){e.next=6;break}return this.highWaterMark=t,e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"packageArrivalLogData",value:(o=t(a().mark((function e(){var t,r,n,o,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Be("u"),Be("onHashPct"),Be("cookieGaId"),Be("view_epoch")]);case 2:return t=e.sent,r=N(t,4),n=r[0],o=r[1],i=r[2],s=r[3],c={cookieGaId:i,lc:0,view_epoch:s,u:n,onHashPct:o},et.log("Arrival log data: ",c),e.abrupt("return",new Blob([JSON.stringify(c)],tt));case 11:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"packageMainLogData",value:(n=t(a().mark((function e(){var t,r,n,o,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},window.beagleInfoLayer){e.next=3;break}return e.abrupt("return",null);case 3:for(r=0,n=Object.entries(window.beagleInfoLayer);r<n.length;r++)o=N(n[r],2),i=o[0],s=o[1],i.startsWith("_")||null===s||(t[i]=s);return t.lc=1,e.abrupt("return",new Blob([JSON.stringify(t)],tt));case 6:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"packageIncrementalLogData",value:(r=t(a().mark((function e(){var t,r,n,o,i,s,c,u,l,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Be("a"),Be("e"),Be("f"),Be("s"),Be("m"),Be("cookieGaId"),Be("view_epoch")]);case 2:return t=e.sent,r=N(t,7),n=r[0],o=r[1],i=r[2],s=r[3],c=r[4],u=r[5],l=r[6],p={cookieGaId:u,lc:2,view_epoch:l,a:n,e:o,f:i,s:s,m:c},et.log("Update log data: ",p),e.abrupt("return",new Blob([JSON.stringify(p)],tt));case 14:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"initializeExitEventListeners",value:function(){var e=this,r=null;et.log("Initializing exit event listener"),window.addEventListener("beforeunload",t(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return et.log("In beforeunload event"),clearTimeout(r),t.next=4,e.handleCloseEvent();case 4:case"end":return t.stop()}}),t)}))),{capture:!0}),window.addEventListener("pagehide",t(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return et.log("In pagehide event"),clearTimeout(r),t.next=4,e.handleCloseEvent();case 4:case"end":return t.stop()}}),t)}))),{capture:!0}),window.addEventListener("visibilitychange",(function(){"hidden"!==window.top.document.visibilityState?(clearTimeout(r),r=null):r=setTimeout(t(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return et.log("In timeout"),t.next=3,e.handleCloseEvent();case 3:case"end":return t.stop()}}),t)}))),3e4)}),{capture:!0})}},{key:"queueLogs",value:function(e){if(navigator.sendBeacon&&"function"==typeof navigator.sendBeacon){var t=navigator.sendBeacon(g,e),r=setInterval((function(){t?(clearInterval(r),et.log("Logs queued successfully")):t=navigator.sendBeacon(g,e)}),10);setTimeout((function(){clearInterval(r),t||et.log("Logs not queued")}),1e3)}else fetch(g,e)}}]),e}(),nt=rt,at=new C("BeagleInfoLayerChecker"),ot=function(){var e=t(a().mark((function e(t){var r,n,o,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return at.log("Checking rule",JSON.stringify(t)),r=t.operator,n=t.condition,o=t.value,e.next=4,it(r);case 4:return i=e.sent,e.abrupt("return",ae(i,n,o));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=t(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return at.log("Searching beagleInfoLayer for key ",t),e.next=3,Be(t,!0,25,1e3);case 3:if(null==(r=e.sent)){e.next=7;break}return at.success("Found key ".concat(t," with value ").concat(r)),e.abrupt("return",r);case 7:return at.failed("Key ".concat(t," not found in beagleInfoLayer")),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),st=new C("BeagleElementChecker"),ct=function(e){st.log("Checking rule",JSON.stringify(e));var t,r=e.operator,n=e.condition,a=e.value,o=e.selector,i=e.selectorAll,s=e.selectorFallback,c=void 0===s?null:s,u=o;if(u&&!window.top.document.querySelector(u)&&(u=c||u),null===r)return ae(window.top.document.querySelector(u),n,a);if(u&&!window.top.document.querySelector(u))return st.failed("Selector not found on page"),!1;if(i&&!window.top.document.querySelectorAll(i))return st.failed("Selector not found on page"),!1;switch(u?t=window.top.document.querySelector(u):i&&(t=Array.from(window.top.document.querySelectorAll(i))),r){case"text-number":var l;l=Array.isArray(t)?t.reduce((function(e,t){return e+parseInt(t.textContent.replace("TL","").replace(".",""))}),0):parseInt(window.top.document.querySelector(u).textContent.replace("TL","").replace(".",""));var p=parseInt(l);return ae(p,n,a);case"classList":return ae(Array.from(t.classList),n,a);case"count":return Array.isArray(t)&&t.length>0?ae(t.length,n,a):ae(t?1:0,n,a);case"style":var d=getComputedStyle(t),f=a.split(":")[0].trim(),h=a.split(":")[1].trim(),v=d[f];return ae(v,n,h);default:return st.failed("Operator not defined"),!1}},ut=new C("BeagleFunctionChecker"),lt=function(e){ut.log("Checking rule",JSON.stringify(e));var t=e.operator,r=e.condition,n=e.value;if(!t)return ut.failed("Rule function not defined"),!1;var a=Function(t)();return ae(a,r,n)},pt=new C("BeagleSessionChecker"),dt=function(e){pt.log("Checking rule",JSON.stringify(e));var t=e.operator,r=e.condition,n=e.value;switch(t){case"duration":return ft(r,n);case"history":return ht(r,n);default:return null}},ft=function(e,t){var r=(Date.now()-function(){try{return new Date(parseInt(window.sessionStorage.getItem(w)))}catch(e){return pt.failed("Could not get session timestamp",e),Date.now()}}())/1e3;return ae(r,e,parseInt(t))},ht=function(e,t){var r,n=null===(r=window.sessionStorage.getItem(x))||void 0===r?void 0:r.split(",");return ae(n,e,t)},vt=new C("BeagleUrlChecker"),mt=function(e){vt.log("Checking rule",JSON.stringify(e));var t=e.operator,r=e.condition,n=e.value;if("path"===t){var a=window.top.location.href,o=new URL(a).pathname;return vt.log("Checking path ".concat(o," matches rule path ").concat(n)),ae(o,r,n)}return null},gt=new C("BeagleEnvChecker"),yt=function(e){gt.log("Checking rule",JSON.stringify(e));var t=e.operator,r=e.condition,n=e.value;if("device_type"===t){var a=window.matchMedia(y).matches?"mobile":"desktop";return ae(a,r,n)}return null},bt="beagle_cache",wt=1,xt={name:"infoCache",indexes:[{name:"ix_sku",fields:"sku"}],options:{keyPath:"sku"}};function kt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return _t(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_t(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var St,It=new C("GlovProductInfoRepository"),At=function(){function e(){i(this,e),this.indexedDB=null,this.init()}var r,n,o,s,c,l,p;return u(e,[{key:"init",value:function(){var e,t=this;It.log("Initializing indexedDB");var r=null===(e=window.top.indexedDB)||void 0===e?void 0:e.open(bt,wt);if(!r)throw new Error("indexeddb is not supported");r.onupgradeneeded=function(e){if(0===e.oldVersion);else try{r.result.deleteObjectStore(xt.name)}catch(e){It.failed("Could not delete outdated database",e.message)}try{var t,n=r.result.createObjectStore(xt.name,xt.options);if((null===(t=xt.indexes)||void 0===t?void 0:t.length)>0){var a,o=kt(xt.indexes);try{for(o.s();!(a=o.n()).done;){var i=a.value;n.createIndex(i.name,i.fields)}}catch(e){o.e(e)}finally{o.f()}}}catch(e){It.failed("Could not create object store on database",e.message)}},r.onerror=function(){throw new Error("Error initializing beagle_cache indexed DB",r.error)},r.onsuccess=function(){t.indexedDB=r.result}}},{key:"getConnection",value:function(){var e=this;return new Promise((function(t,r){var n=setInterval((function(){e.indexedDB&&(clearInterval(n),t())}),25);setTimeout((function(){e.indexedDB||(clearInterval(n),r(new Error("IndexedDB not initialized within the allotted time")))}),5e3)}))}},{key:"initTransaction",value:(p=t(a().mark((function e(){var t,r,n=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],e.next=3,this.getConnection();case 3:return r=this.indexedDB.transaction(xt.name,t?"readwrite":"readonly"),e.abrupt("return",r.objectStore(xt.name));case 5:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"save",value:(l=t(a().mark((function e(t){var r,n,o,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initTransaction(!0);case 2:if(r=e.sent,n=Math.round(Date.now()/1e3),Array.isArray(t)){o=kt(t);try{for(o.s();!(i=o.n()).done;)(s=i.value).timestamp=n,r.put(s)}catch(e){o.e(e)}finally{o.f()}}else t.timestamp=n,r.put(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"clear",value:(c=t(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.initTransaction(!0).then((function(t){var r=t.clear();r.onsuccess=function(){e()},r.onerror=function(){It.failed("Error clearing store: ".concat(t.name)),e(null)}}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"get",value:(s=t(a().mark((function e(t){var r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){r.initTransaction().then((function(r){var n=r.get(t);n.onsuccess=function(){var r=n.result;It.log("Found value ".concat(r," for key ").concat(t)),e(r)},n.onerror=function(){It.failed("Error getting value for key: ".concat(t),n.onerror),e(null)}}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"count",value:(o=t(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.initTransaction().then((function(t){var r=t.count();r.onsuccess=function(){var t=r.result;It.log("Counted ".concat(t," entries")),e(t)},r.onerror=function(){It.failed("Error counting entries: ",r.onerror),e(null)}}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"getCursor",value:(n=t(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.initTransaction().then((function(t){var r=t.openCursor();r.onsuccess=function(t){e(t.target.result)},r.onerror=function(){It.failed("Error getting cursor",r.onerror),e(null)}}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"persistProductInfo",value:(r=t(a().mark((function e(){var t,r,n,o,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Re("m","check-existing-prod-info"),e.next=3,this.count();case 3:if(!e.sent){e.next=14;break}return It.log("Existing product info found"),e.next=8,this.getCursor();case 8:if(t=e.sent,r=t.value.timestamp,!(Date.now()/1e3-r<7200)){e.next=13;break}return e.abrupt("return");case 13:It.log("Existing product info is expired");case 14:return Re("m","fetching-prod-info"),n=Y(),o=this.clear(),e.next=19,Promise.all([n,o]);case 19:if(i=e.sent,s=N(i,1),(c=s[0])&&c.length){e.next=24;break}return e.abrupt("return");case 24:return Re("m","fetched-prod-info"),e.next=27,this.save(this.preparePayloads(c));case 27:Re("m","persisted-prod-info");case 28:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"preparePayloads",value:function(e){var t=[],r=e.shift();r.shift();var n,a=kt(e);try{for(a.s();!(n=a.n()).done;){for(var o=n.value,i={sku:o.shift()},s=0;s<r.length;s++)i[r[s]]=o[s]||0;t.push(i)}}catch(e){a.e(e)}finally{a.f()}return t}}]),e}(),Lt=At,Tt=(St=null,{getInstance:function(){return null===St&&((St=new Lt).constructor=null),St}}),Dt=new C("BeagleProductInfoChecker"),Pt=function(){var e=t(a().mark((function e(t){var r,n,i,s,c,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Dt.log("Checking rule",JSON.stringify(t)),n=t.operator,i=t.condition,s=t.value,e.next=4,Be("__features.SKUsonPage",!0);case 4:if((c=e.sent)&&("object"!==o(c)||Object.keys(c).length)){e.next=7;break}return e.abrupt("return",!1);case 7:u=null,l=null===(r=c[Object.keys(c)[0]])||void 0===r?void 0:r.id,e.t0=n,e.next="transactionIn2Weeks"===e.t0?12:"addToCartIn2Weeks"===e.t0?17:"productViewCount"===e.t0?22:27;break;case 12:return Dt.log("Getting TransactionCount for sku ",l),e.next=15,Et(l);case 15:case 20:case 25:return u=e.sent,e.abrupt("break",27);case 17:return Dt.log("Getting AddToCartCount for sku ",l),e.next=20,Ot(l);case 22:return Dt.log("Getting productViewCount for sku ",l),e.next=25,Ct(l);case 27:return e.abrupt("return",ae(u,i,s));case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Et=function(){var e=t(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.getInstance().get(t);case 2:if(r=e.sent,!t||!r){e.next=5;break}return e.abrupt("return",r.saleCntVisitorsIn15);case 5:return e.abrupt("return",-1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ot=function(){var e=t(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.getInstance().get(t);case 2:if(r=e.sent,!t||!r){e.next=5;break}return e.abrupt("return",r.cartCntVisitorsIn15);case 5:return e.abrupt("return",-1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ct=function(){var e=t(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tt.getInstance().get(t);case 2:if(r=e.sent,!t||!r){e.next=5;break}return e.abrupt("return",r.viewCntVisitorsIn1);case 5:return e.abrupt("return",-1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const Rt=new Error("request for lock canceled");class jt{constructor(e,t=Rt){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(((t,r)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:r}),this._dispatch()}))}runExclusive(e,t=1){return r=this,n=void 0,o=function*(){const[r,n]=yield this.acquire(t);try{return yield e(r)}finally{n()}},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{c(o.next(e))}catch(e){t(e)}}function s(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(i,s)}c((o=o.apply(r,n||[])).next())}));var r,n,a,o}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()}))}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach((e=>e.forEach((e=>e.reject(this._cancelError))))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const r=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!r)continue;const n=this._value,a=t;this._value-=t,t=this._value+1,r.resolve([n,this._newReleaser(a)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach((e=>e())),this._weightedWaiters[e-1]=[])}}class Nt{constructor(e){this._semaphore=new jt(1,e)}acquire(){return e=this,t=void 0,n=function*(){const[,e]=yield this._semaphore.acquire();return e},new((r=void 0)||(r=Promise))((function(a,o){function i(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}));var e,t,r,n}runExclusive(e){return this._semaphore.runExclusive((()=>e()))}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}function Mt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Bt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function Bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Gt=new C("BeagleRuleEngine"),Qt=function(){function e(t){i(this,e);var r=t.eligibilityRules,n=t.baseRuleSet;this.baseRuleSet=n,this.eligibilityRules=r,this.addedDataListeners=[],this.mutex=new Nt}var r,n,o,s,c;return u(e,[{key:"checkRules",value:(c=t(a().mark((function e(){var t,r,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Mt(this.baseRuleSet),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=12;break}return n=r.value,e.next=7,this.checkRule(n);case 7:if(e.sent){e.next=10;break}return e.abrupt("return",!1);case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),t.e(e.t0);case 17:return e.prev=17,t.f(),e.finish(17);case 20:return e.abrupt("return",!0);case 21:case"end":return e.stop()}}),e,this,[[1,14,17,20]])}))),function(){return c.apply(this,arguments)})},{key:"checkRule",value:(s=t(a().mark((function e(t){var r,n,o,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.chain,n=t.chain_condition,o=t.type,i=null,e.t0=o,e.next="session"===e.t0?5:"element"===e.t0?7:"dataLayer"===e.t0?9:"url"===e.t0?13:"function"===e.t0?15:"environment"===e.t0?17:"productInfoLookup"===e.t0?19:23;break;case 5:return i=dt(t),e.abrupt("break",25);case 7:return i=ct(t),e.abrupt("break",25);case 9:return e.next=11,ot(t);case 11:return i=e.sent,e.abrupt("break",25);case 13:return i=mt(t),e.abrupt("break",25);case 15:return i=lt(t),e.abrupt("break",25);case 17:return i=yt(t),e.abrupt("break",25);case 19:return e.next=21,Pt(t);case 21:return i=e.sent,e.abrupt("break",25);case 23:return Gt.failed("No such rule type: ".concat(o)),e.abrupt("return",null);case 25:if(!r){e.next=51;break}e.t1=n,e.next="and"===e.t1?29:"or"===e.t1?36:"xor"===e.t1?43:49;break;case 29:if(e.t2=i,!e.t2){e.next=34;break}return e.next=33,this.checkRule(r);case 33:e.t2=e.sent;case 34:return i=e.t2,e.abrupt("break",51);case 36:if(e.t3=i,e.t3){e.next=41;break}return e.next=40,this.checkRule(r);case 40:e.t3=e.sent;case 41:return i=e.t3,e.abrupt("break",51);case 43:return e.t4=i,e.next=46,this.checkRule(r);case 46:return e.t5=e.sent,i=e.t4!=e.t5,e.abrupt("break",51);case 49:return Gt.failed("No such chain condition"),e.abrupt("break",51);case 51:return e.abrupt("return",i);case 52:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"assesEligibilityRules",value:function(){var e=t(a().mark((function e(){var t,r,n,o,i,s,c,u,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Re("m","assessing-eligibility-rules"),t=0,r=Object.entries(this.eligibilityRules);case 2:if(!(t<r.length)){e.next=31;break}n=N(r[t],2),o=n[0],i=n[1],s=[],this.setUpListeners(o,i),c=Mt(i),e.prev=7,c.s();case 9:if((u=c.n()).done){e.next=19;break}return l=u.value,e.next=13,this.checkRule(l);case 13:if(!e.sent){e.next=17;break}if(s.push(l.name),"PageType"!==o){e.next=17;break}return e.abrupt("break",19);case 17:e.next=9;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(7),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:Re("__eRules.".concat(o),s);case 28:t++,e.next=2;break;case 31:case"end":return e.stop()}}),e,this,[[7,21,24,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"assesEligibilityRulesCallBack",value:(o=t(a().mark((function e(t,r){var n,o,i,s,c,u=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&r&&r.length){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.mutex.acquire();case 4:n=e.sent,Gt.log("Lock acquired for key ".concat(t)),e.prev=6,o=Mt(r),e.prev=8,s=a().mark((function e(){var r,n,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.value,e.next=3,u.checkRule(r);case 3:return n=e.sent,e.next=6,Be("__eRules.".concat(t));case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0=[];case 9:if(o=e.t0,!n){e.next=19;break}if(!o.includes(r.name)){e.next=13;break}return e.abrupt("return","continue");case 13:if(o.push(r.name),Re("__eRules.".concat(t),o),"PageType"!==t){e.next=17;break}return e.abrupt("return","break");case 17:e.next=21;break;case 19:s=o.filter((function(e){return e!==r.name})),Re("__eRules.".concat(t),s);case 21:case"end":return e.stop()}}),e)})),o.s();case 11:if((i=o.n()).done){e.next=20;break}return e.delegateYield(s(),"t0",13);case 13:if("continue"!==(c=e.t0)){e.next=16;break}return e.abrupt("continue",18);case 16:if("break"!==c){e.next=18;break}return e.abrupt("break",20);case 18:e.next=11;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(8),o.e(e.t1);case 25:return e.prev=25,o.f(),e.finish(25);case 28:e.next=33;break;case 30:e.prev=30,e.t2=e.catch(6),Gt.failed("Error assessing rules for key: ".concat(t," - ").concat(e.t2.message));case 33:return e.prev=33,Gt.log("Releasing lock for key: ".concat(t)),n(),e.finish(33);case 37:case"end":return e.stop()}}),e,this,[[6,30,33,37],[8,22,25,28]])}))),function(e,t){return o.apply(this,arguments)})},{key:"setUpListeners",value:(n=t(a().mark((function e(t,r){var n,o,i,s,c,u,l,p,d,f,h,v,m=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=this.extractRuleAttributes(r),o=n.dataLayerRules,i=n.elementRules,s=0,c=Object.entries(o);s<c.length;s++)u=N(c[s],2),l=u[0],p=u[1],d=this.assesEligibilityRulesCallBack.bind(this,t,p),Ne(l,d);for(f=function(){var e=N(v[h],2),r=e[0],n=e[1],a=new MutationObserver((function(e){var r,a=[],o=Mt(e);try{for(o.s();!(r=o.n()).done;){var i=r.value;a=[].concat(M(a),M(Array.from(i.addedNodes)),M(Array.from(i.removedNodes)))}}catch(e){o.e(e)}finally{o.f()}a.every((function(e){return void 0===e.tagName}))||m.assesEligibilityRulesCallBack(t,n)})),o=document.querySelector(r);o=o?o.parentNode:document.body,a.observe(o,{subtree:!0,childList:!0})},h=0,v=Object.entries(i);h<v.length;h++)f();case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"extractRuleAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e&&e.length){var n,a=Mt(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,i=o.type;switch(i){case"dataLayer":t[o.operator]||(t[o.operator]=[]),t[o.operator].push(o);break;case"element":r[o.selector||o.selectorAll]||(r[o.selector||o.selectorAll]=[]),r[o.selector||o.selectorAll].push(o)}o.chain&&this.extractRuleAttributes([o.chain],t,r)}}catch(e){a.e(e)}finally{a.f()}return{dataLayerRules:t,elementRules:r}}}}],[{key:"getEligibilityRules",value:(r=t(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=window.sessionStorage.getItem(A))){e.next=4;break}return e.abrupt("return",JSON.parse(t));case 4:return e.next=6,K();case 6:return t=e.sent,window.sessionStorage.setItem(A,JSON.stringify(t)),e.abrupt("return",t);case 11:return e.prev=11,e.t0=e.catch(0),Gt.failed("Could not get eligibility rules: ",e.t0.message),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])}))),function(){return r.apply(this,arguments)})}]),e}(),qt=new C("SegmentationComputer");function Ft(e){return Vt.apply(this,arguments)}function Vt(){return(Vt=t(a().mark((function e(t){var r,n,o,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:qt.log("Determining user segment"),e.prev=1,r=0,n=Object.keys(t);case 3:if(!(r<n.length)){e.next=18;break}if(i=n[r],s=null===(o=t[i])||void 0===o?void 0:o.ruleSet){e.next=8;break}return e.abrupt("continue",15);case 8:return c=new Qt({baseRuleSet:s,businessRuleSet:[]}),e.next=11,c.checkRules();case 11:if(!e.sent){e.next=15;break}return qt.log("User segment matched: ".concat(i)),Re("s",i),e.abrupt("return",i);case 15:r++,e.next=3;break;case 18:return qt.log("User segment not matched, returning default"),Re("s","default"),e.abrupt("return","default");case 23:return e.prev=23,e.t0=e.catch(1),qt.failed("Could not compute user segment"),e.abrupt("return",null);case 27:case"end":return e.stop()}}),e,null,[[1,23]])})))).apply(this,arguments)}function Ut(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Wt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ht=new C("BeagleTreatmentRepository"),Jt=function(){function e(t){i(this,e);var r=t.treatments,n=t.treatmentWeights;this.treatments=r,this.treatmentWeights=n}var r,n,o;return u(e,[{key:"getMatchedTreatments",value:(o=t(a().mark((function e(){var t,r,n,o,i,s,c,u,l,p,d,f,h,v,m,g;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.treatments,r=this.treatmentWeights,e.next=3,Ft(r);case 3:if(n=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:if(!r){e.next=44;break}o=n&&r[n]?r[n]:r.default,i=Ut(t),e.prev=9,i.s();case 11:if((s=i.n()).done){e.next=36;break}if((u=s.value).weight=(null===(c=o[null==u?void 0:u.id])||void 0===c?void 0:c.weight)||0,u.actions.some((function(e){return e.variants}))){e.next=16;break}return e.abrupt("continue",34);case 16:l=Ut(u.actions),e.prev=17,l.s();case 19:if((p=l.n()).done){e.next=26;break}if((d=p.value).variants){e.next=23;break}return e.abrupt("continue",24);case 23:for(f=0,h=Object.keys(d.variants);f<h.length;f++)g=h[f],null!==(v=o[u.id])&&void 0!==v&&v.variants&&null!==(m=o[u.id])&&void 0!==m&&m.variants[g]&&(d.variants[g].weight=o[u.id].variants[g]);case 24:e.next=19;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(17),l.e(e.t0);case 31:return e.prev=31,l.f(),e.finish(31);case 34:e.next=11;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(9),i.e(e.t1);case 41:return e.prev=41,i.f(),e.finish(41);case 44:if(Ht.log("".concat(t.length," treatments user segment matched")),t.length){e.next=47;break}return e.abrupt("return",[]);case 47:return e.abrupt("return",t);case 48:case"end":return e.stop()}}),e,this,[[9,38,41,44],[17,28,31,34]])}))),function(){return o.apply(this,arguments)})}],[{key:"getTreatments",value:(n=t(a().mark((function e(){var t,r,n,o,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ht.log("Loading treatments"),t="BG_Treatments",r=JSON.parse(window.sessionStorage.getItem(t)),n=null==r?void 0:r.treatments,o=null==r?void 0:r.timestamp,n&&o){e.next=16;break}return Ht.failed("Treatments not found in local storage"),e.next=9,J();case 9:if(n=e.sent){e.next=13;break}return Ht.failed("Failed to fetch treatments"),e.abrupt("return",null);case 13:return i={timestamp:Date.now(),treatments:n},window.sessionStorage.setItem(t,JSON.stringify(i)),e.abrupt("return",n);case 16:if(!o){e.next=29;break}if(!((Date.now()-o)/864e5>1)){e.next=29;break}return Ht.failed("Treatments are expired"),e.next=22,J();case 22:if(n=e.sent){e.next=26;break}return Ht.failed("Failed to fetch treatments"),e.abrupt("return",null);case 26:return s={timestamp:Date.now(),treatments:n},window.sessionStorage.setItem(t,JSON.stringify(s)),e.abrupt("return",n);case 29:return Ht.success("Treatments are loaded from local storage"),e.abrupt("return",n);case 31:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"getTreatmentWeights",value:(r=t(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=window.sessionStorage.getItem(I))){e.next=4;break}return e.abrupt("return",JSON.parse(t));case 4:return e.next=6,z();case 6:if(t=e.sent){e.next=10;break}return Ht.failed("Failed to fetch weights"),e.abrupt("return",null);case 10:return window.sessionStorage.setItem(I,JSON.stringify(t)),e.abrupt("return",t);case 14:return e.prev=14,e.t0=e.catch(0),Ht.warn(e.t0.message),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[0,14]])}))),function(){return r.apply(this,arguments)})}]),e}(),zt=Jt;function $t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Kt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Yt=new C("ReplaceUtils"),Xt=function(){var e=t(a().mark((function e(t,r){var n,i,s,c,u,p,d,f,h,v,m,g;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=27;break}n=$t(t.entries()),e.prev=2,n.s();case 4:if((i=n.n()).done){e.next=17;break}if(s=N(i.value,2),c=s[0],u=s[1],"object"!==o(p=Array.isArray(r)?r[c]:r||"")){e.next=14;break}return e.next=10,er(p);case 10:d=e.sent,t[c]=l(u,"{{REPLACE}}",d),e.next=15;break;case 14:t[c]=Zt(p,u);case 15:e.next=4;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),n.e(e.t0);case 22:return e.prev=22,n.f(),e.finish(22);case 25:e.next=61;break;case 27:if(!Array.isArray(r)){e.next=53;break}f=$t(r),e.prev=29,f.s();case 31:if((h=f.n()).done){e.next=43;break}if("object"!==o(v=h.value)){e.next=40;break}return e.next=36,er(v);case 36:m=e.sent,t=t.replace("{{REPLACE}}",m),e.next=41;break;case 40:t=Zt(v,t,!0);case 41:e.next=31;break;case 43:e.next=48;break;case 45:e.prev=45,e.t1=e.catch(29),f.e(e.t1);case 48:return e.prev=48,f.f(),e.finish(48);case 51:e.next=61;break;case 53:if("object"!==o(r)){e.next=60;break}return e.next=56,er(r);case 56:g=e.sent,t=l(t,"{{REPLACE}}",g),e.next=61;break;case 60:t=Zt(r,t);case 61:return e.abrupt("return",t);case 62:case"end":return e.stop()}}),e,null,[[2,19,22,25],[29,45,48,51]])})));return function(t,r){return e.apply(this,arguments)}}();function Zt(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e&&t.includes("{{REPLACE}}")){Yt.log("Executing replace function: ",e);var n=Function(e);return r?t.replace("{{REPLACE}}",n()):l(t,"{{REPLACE}}",n())}return t}function er(e){return tr.apply(this,arguments)}function tr(){return(tr=t(a().mark((function e(t){var r,n,o,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.storage,n=t.key,o=t.keyFallback,i=t.type,e.t0=r,e.next="session"===e.t0?4:"info-layer"===e.t0?18:26;break;case 4:if(s=null,(s=window.sessionStorage.getItem(n))||(s=window.sessionStorage.getItem(o)),!i){e.next=17;break}e.prev=8,s=(s=JSON.parse(s))[s.length-1][i],e.next=17;break;case 13:return e.prev=13,e.t1=e.catch(8),Yt.failed("Could not parse ".concat(s)),e.abrupt("return",null);case 17:return e.abrupt("return",s);case 18:return e.next=20,Be(n);case 20:if(c=e.sent){e.next=25;break}return e.next=24,Be(o);case 24:c=e.sent;case 25:return e.abrupt("return",c);case 26:case"end":return e.stop()}}),e,null,[[8,13]])})))).apply(this,arguments)}var rr=Xt,nr=new C("ActionConditionUtils"),ar=function(){var e=t(a().mark((function e(t){var r,n,o,i,s,c,u,l,p,d,f,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:nr.log("Action condition found: ",t),r=[],n=t.attribute,o=t.inner_condition,i=t.operator,s=t.selector,c=t.type,u=t.value,l=t.chain,p=Array.from(window.top.document.querySelectorAll(s)),d=0,f=p;case 5:if(!(d<f.length)){e.next=14;break}return h=f[d],e.next=9,or(h,c,i,n,o,u,l);case 9:if(!e.sent){e.next=11;break}r.push($(h));case 11:d++,e.next=5;break;case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),or=function(){var e=t(a().mark((function e(t,r,n,o,i,s,c){var u,l,p,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next="productInfoLookup"===e.t0?3:20;break;case 3:return u=t.getAttribute(o),e.next=6,Tt.getInstance().get(u);case 6:if(l=e.sent,null!=(p=null==l?void 0:l[n])){e.next=11;break}return nr.failed("Product info is empty"),e.abrupt("return",!1);case 11:if(ae(p,i,s)){e.next=13;break}return e.abrupt("return",!1);case 13:if(!c){e.next=19;break}return e.next=16,or(t,c.type,c.operator,c.attribute,c.inner_condition,c.value,c.chain);case 16:if(e.sent){e.next=19;break}return e.abrupt("return",!1);case 19:return e.abrupt("break",29);case 20:if(d=t.getAttribute(o),ae(d,i,s)){e.next=23;break}return e.abrupt("return",!1);case 23:if(!c){e.next=29;break}return e.next=26,or(t,c.type,c.operator,c.attribute,c.inner_condition,c.value,c.chain);case 26:if(e.sent){e.next=29;break}return e.abrupt("return",!1);case 29:return e.abrupt("return",!0);case 30:case"end":return e.stop()}}),e)})));return function(t,r,n,a,o,i,s){return e.apply(this,arguments)}}(),ir=ar;function sr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return cr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ur(){return ur=t(a().mark((function e(r){var n,o,i,s,c,u,d,f,h,v,m,g,w,x,_;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new C("BeagleApplyActions"),o=k,i=function(){var e=t(a().mark((function e(t){var r,i,s,l,d,f,w,x,k,_,S,I,A,L,T,D,P,E,O,C,R,j,M,B,G,Q,q,F,V,U,W,H,J,z,K,Y,X,Z,ee=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ee.length>1&&void 0!==ee[1]?ee[1]:null,n.log("Applying action: ",JSON.stringify(t)),i=t.operator,s=t.type,l=t.applyEvent,d=t.contentSelector,f=t.selector,w=t.selectorFallback,x=t.mdCondition,k=t.move_selector_1,_=t.move_selector_2,S=t.replaceFn,I=t.pType,A=t.attribute,L=t.productInfoStorage,"noop"!==i){e.next=6;break}return n.failed("Noop Operator: No operation is applied on target "),e.abrupt("return",!0);case 6:if(T=t.value,r=r?r.find(f):$(f),!x||window.matchMedia(x).matches){e.next=12;break}return n.failed("Media condition mismatch: ",x),e.abrupt("return",!1);case 12:if(!(k&&!_||_&&!k)){e.next=15;break}return n.failed("Both move selectors are required"),e.abrupt("return",!1);case 15:if(!k||!_){e.next=24;break}if($(k).length){e.next=19;break}return n.failed("Move selector 1 not found: ",k),e.abrupt("return",!1);case 19:if($(_).length){e.next=22;break}return n.failed("Move selector 2 not found: ",_),e.abrupt("return",!1);case 22:e.next=39;break;case 24:if(f){e.next=29;break}return n.failed("Selector not specified"),e.abrupt("return",!1);case 29:if(r.length){e.next=39;break}if($(w).length||"remove"!==i){e.next=32;break}return e.abrupt("return",!0);case 32:if("no-selector"===f){e.next=39;break}if(n.failed("Selector not found: ",f),n.log("Trying fallback selector: ",w),w&&(r=$(w)),r.length){e.next=39;break}return n.failed("Fallback selector not found"),e.abrupt("return",!1);case 39:if(!S){e.next=43;break}return e.next=42,rr(T,S);case 42:T=e.sent;case 43:if("remove"!==i){e.next=47;break}r.length?(n.log("Removing: ",f),r.remove()):n.log("Cannot found element with selector: ",f),e.next=218;break;case 47:if("insert"!==i){e.next=121;break}e.t0=s,e.next="before"===e.t0?51:"after"===e.t0?55:"append"===e.t0?58:"modal"===e.t0?61:"popup"===e.t0?66:117;break;case 51:return n.log("Inserting before: ",T),String(T).includes("nd-add-to-win")&&$(".nd-add-to-win").remove(),r.before(T),e.abrupt("break",119);case 55:return n.log("Inserting after: ",T),r.after(T),e.abrupt("break",119);case 58:return n.log("Appending value: ",T),r.append(T),e.abrupt("break",119);case 61:return r.off("click"),m(T,d,!0),(D=document.querySelector(f)).addEventListener("click",(function(e){D==e.target&&e.stopPropagation(),v(T,d)}),!0),e.abrupt("break",119);case 66:if(0===parseInt(sessionStorage.getItem(o))){e.next=69;break}return n.log("Popup already displayed in session"),e.abrupt("break",119);case 69:if(n.log("Creating Popup: ",T),!I){e.next=74;break}return e.next=73,c(I,T,L);case 73:T=e.sent;case 74:if(m(T,d),!l){e.next=115;break}P=window.matchMedia(y).matches,E=sr(l),e.prev=78,E.s();case 80:if((O=E.n()).done){e.next=105;break}C=O.value,e.t1=C,e.next="exitIntent"===e.t1?85:"copyIntent"===e.t1?100:103;break;case 85:if(n.log("Adding exit intent listener"),!P){e.next=98;break}return window.top.addEventListener("visibilitychange",h),e.next=90,Promise.all([Be("r",!0),Be("d",!0)]);case 90:R=e.sent,j=N(R,2),M=j[0],B=j[1],"string"!=typeof M||"string"!=typeof B||M.includes(B)||window.history&&"function"==typeof window.history.pushState&&("complete"!==window.top.document.readyState?window.top.addEventListener("load",(function(){"bg_limbo"!==window.history.state&&window.history.pushState("bg_limbo",""),window.top.addEventListener("popstate",h,{once:!0})})):("bg_limbo"!==window.history.state&&window.history.pushState("bg_limbo",""),window.top.addEventListener("popstate",h,{once:!0}))),le(b,h),e.next=99;break;case 98:window.top.document.documentElement.addEventListener("mouseleave",h,{once:!0});case 99:return e.abrupt("break",103);case 100:return n.log("Adding copy intent listener"),window.top.document.documentElement.addEventListener("copy",h,{once:!0}),e.abrupt("break",103);case 103:e.next=80;break;case 105:e.next=110;break;case 107:e.prev=107,e.t2=e.catch(78),E.e(e.t2);case 110:return e.prev=110,E.f(),e.finish(110);case 113:e.next=116;break;case 115:setTimeout((function(){h()}),timeout);case 116:return e.abrupt("break",119);case 117:return n.failed("Type: ".concat(s," not found for operator: ").concat(i)),e.abrupt("break",119);case 119:e.next=218;break;case 121:if("edit"!==i){e.next=149;break}e.t3=s,e.next="text"===e.t3?125:"html"===e.t3?128:"styleApplicator"===e.t3?131:"addClass"===e.t3?136:"removeClass"===e.t3?139:"documentTitle"===e.t3?142:145;break;case 125:return n.log("Editing text: ",T),r.text(T),e.abrupt("break",147);case 128:return n.log("Editing html: ",T),r.html(T),e.abrupt("break",147);case 131:return n.log("Applying style: ",T),G=JSON.parse(T),n.log("Style Changes Map: ",G),te(r,G),e.abrupt("break",147);case 136:return n.log("addding class to ".concat(r," named ").concat(T)),r.addClass(T),e.abrupt("break",147);case 139:return n.log("remove class from ".concat(r," named ").concat(T)),r.removeClass(T),e.abrupt("break",147);case 142:if(n.log("changing document title from ".concat(r," to ").concat(T)),l){Q=sr(l);try{for(Q.s();!(q=Q.n()).done;)"tabChange"==q.value&&function(){n.log("catching event tabchange..");var e=window.top.document.title;window.top.document.addEventListener("visibilitychange",(function(t){setTimeout((function(){u(t,T,e)}),15e3)}))}()}catch(e){Q.e(e)}finally{Q.f()}}return e.abrupt("break",147);case 145:return n.log("Unknown edit type: ",s),e.abrupt("break",147);case 147:e.next=218;break;case 149:if("setattribute"!==i){e.next=166;break}n.log("Setting attribute: ",A,T),e.t4=A,e.next="src"===e.t4?154:"style"===e.t4?156:160;break;case 154:return r.css("content","url(".concat(T.trim(),")")),e.abrupt("break",164);case 156:return F=T.split(":")[0].trim(),V=T.split(":")[1].trim(),r.css(F,V,"!important"),e.abrupt("break",164);case 160:return T.includes("function")&&(T=Function(T)),r.attr(A,T),n.log("Unhandled attribute: Setting attribute: ",A,T),e.abrupt("break",164);case 164:e.next=218;break;case 166:if("replace"!==i){e.next=171;break}n.log("Replacing: ",T),r.replaceAll(T),e.next=218;break;case 171:if("swap"!==i){e.next=178;break}n.log("Swapping: ",k,_),U=window.top.document.querySelector(k),W=window.top.document.querySelector(_),g(U,W),e.next=218;break;case 178:if("injectscript"!==i){e.next=183;break}n.log("Injecting script: ",T),r.append("<script>".concat(T,"<\/script>")),e.next=218;break;case 183:if("move"!==i){e.next=191;break}n.log("Moving ".concat(k," to ").concat(_)),H=window.top.document.querySelector(k),J=window.top.document.querySelector(_),H.remove(),J.prepend(H),e.next=218;break;case 191:if("productInfoLookup"!==i){e.next=198;break}return e.next=194,c(I,T,L);case 194:z=e.sent,r.before(z),e.next=218;break;case 198:if("text-transform"!==i){e.next=217;break}e.t5=s,e.next="capitalize"===e.t5?202:"PLACEHOLDER"===e.t5?213:214;break;case 202:K=0,Y=Array.from(r);case 203:if(!(K<Y.length)){e.next=212;break}if(Z=Y[K],null===(X=Z.innerText)||void 0===X||!X.includes("\n")){e.next=208;break}return Z.innerText=p(Z.innerText).split("\n").map((function(e){return e.split(" ").map((function(e){return e.charAt(0).toLocaleUpperCase()+e.slice(1)})).join(" ")})).join("\n"),e.abrupt("continue",209);case 208:Z.innerText=p(Z.innerText).split(" ").map((function(e){return e.charAt(0).toLocaleUpperCase()+e.slice(1)})).join(" ");case 209:K++,e.next=203;break;case 212:case 213:case 214:return e.abrupt("break",215);case 215:e.next=218;break;case 217:n.failed("No such operator exists yet",i);case 218:case"end":return e.stop()}}),e,null,[[78,107,110,113]])})));return function(t){return e.apply(this,arguments)}}(),s=function(e,t){return e&&t.includes("{{REPLACE_PRODUCTINFO}}")&&(t=l(t,"{{REPLACE_PRODUCTINFO}}",e)),t},c=function(){var e=t(a().mark((function e(t,r,o){var i,c,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("basket"!==o){e.next=6;break}return e.next=3,Be("__features.SKUsonLastCartView",!0);case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,Be("__features.SKUsonPage",!0);case 8:e.t0=e.sent;case 9:if(i=e.t0,c=null,i&&0!==i.length){e.next=14;break}return n.log("No sku found"),e.abrupt("return",null);case 14:return e.next=16,Tt.getInstance().get(i[0]);case 16:u=e.sent,e.t1=t,e.next="transactionIn2Weeks"===e.t1?20:"addToCartIn2Weeks"===e.t1?23:"productViewCount"===e.t1?26:29;break;case 20:return c=s(u.saleCntVisitorsIn15.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),r),n.log("Replacing transcationIn2Weeks ",u.saleCntVisitorsIn15),e.abrupt("break",30);case 23:return c=s(u.cartCntVisitorsIn15.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),r),n.log("Replacing AddToCartCount ",u.cartCntVisitorsIn15),e.abrupt("break",30);case 26:return c=s(u.viewCntVisitorsIn1.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),r),n.log("Replacing productViewCount for",u.viewCntVisitorsIn1),e.abrupt("break",30);case 29:n.failed("no such type found for productInfoLookup operator: "+t);case 30:return e.abrupt("return",c);case 31:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),u=function(){var e=t(a().mark((function e(t,r,n){var o,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Array.isArray(r)?r:[r],i=sr(o),e.prev=2,i.s();case 4:if((s=i.n()).done){e.next=18;break}if(c=s.value,!window.top.document.hidden){e.next=15;break}return window.top.document.title=c,e.next=10,ue(2e3);case 10:return window.top.document.title=n,e.next=13,ue(2e3);case 13:e.next=16;break;case 15:window.top.document.title=n;case 16:e.next=4;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:window.top.document.hidden?u(t,r,n):window.top.document.title=n;case 27:case"end":return e.stop()}}),e,null,[[2,20,23,26]])})));return function(t,r,n){return e.apply(this,arguments)}}(),d=function e(t){var r=t.target.id;r&&"nd-popup__wrapper"===r&&($("#nd-popup__wrapper").remove(),window.removeEventListener("click",e,!0),window.removeEventListener("touchend",e,!0))},f=function e(t){var r=t.target.classList;r&&r.contains("nd-modal__wrapper")&&($(".nd-modal__wrapper").hide(),window.removeEventListener("click",e,!0),window.removeEventListener("touchend",e,!0))},h=function e(){if(!(window.top.document.hidden||parseInt(sessionStorage.getItem(o))>0)){sessionStorage.setItem(o,1);var t=window.top.document.querySelector("#grt-shadow-host");t&&(t.style.display="none"),window.top.document.getElementById("nd-popup__wrapper").style.display="block",window.addEventListener("click",d,!0),window.addEventListener("touchend",d,!0),window.top.document.documentElement.removeEventListener("mouseleave",e,{once:!0}),window.top.document.documentElement.removeEventListener("copy",e,{once:!0}),window.top.removeEventListener("visibilitychange",e),window.top.removeEventListener("popstate",e,{once:!0}),setTimeout((function(){$("#nd-popup__wrapper").remove(),window.removeEventListener("click",d,!0),window.removeEventListener("touchend",d,!0)}),15e3)}},v=function(e,t){if(!window.top.document.hidden){var r=window.top.document.querySelector("#grt-shadow-host");r&&(r.style.display="none"),window.top.document.querySelector(".nd-modal__wrapper")||m(e,t,!0),window.top.document.querySelector(".nd-modal__wrapper").style.display="block",window.addEventListener("click",f,!0)}},m=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=window.top.document.createElement("div");n.classList.add("nd-popup__wrapper"),r&&n.classList.add("nd-modal__wrapper"),r||(n.id="nd-popup__wrapper");var a=window.top.document.createElement("button"),o=r?"nd-popup__button-close__colored":"nd-popup__button-close";if(a.classList.add(o),a.innerText="X",a.onclick=r?function(){$(".nd-modal__wrapper").hide(),window.removeEventListener("click",f,!0)}:function(){$("#nd-popup__wrapper").remove(),window.removeEventListener("click",d,!0)},t)for(var i=Array.from(window.top.document.querySelectorAll(t));e.includes("{{REPLACE}}")&&i.length>0;)e=e.replace("{{REPLACE}}",i.shift().src);var s=window.top.document.createElement("template");s.innerHTML=e.trim();var c=s.content.firstChild;c.appendChild(a),n.appendChild(c),$("#nd-popup__wrapper").remove(),window.top.document.body.appendChild(n)},g=function(e,t){var r,n,a=e.parentNode,o=t.parentNode;if(a&&o&&!a.isEqualNode(t)&&!o.isEqualNode(e)){for(var i=0;i<a.children.length;i++)a.children[i].isEqualNode(e)&&(r=i);for(var s=0;s<o.children.length;s++)o.children[s].isEqualNode(t)&&(n=s);a.isEqualNode(o)&&r<n&&n++,a.insertBefore(t,a.children[r]),o.insertBefore(e,o.children[n])}},w=function(){return new Promise((function(e){if(window.jQuery)e(!0);else{n.log("jQuery not found, retrying");var r=setInterval((function(){window.jQuery&&(clearInterval(r),e(!0))}),25);setTimeout(t(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:clearInterval(r),e(!1);case 2:case"end":return t.stop()}}),t)}))),2e3)}}))},x=function(){var e=t(a().mark((function e(t){var r,o,s,c,u,l,p,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:if(!e.sent){e.next=59;break}r=sr(t),e.prev=4,r.s();case 6:if((o=r.n()).done){e.next=49;break}if(s=o.value,e.prev=8,c=!1,!s.condition){e.next=36;break}return e.next=13,ir(s.condition);case 13:u=e.sent,l=sr(u),e.prev=15,l.s();case 17:if((p=l.n()).done){e.next=26;break}return d=p.value,e.next=21,i(s,d);case 21:if(!1!==(c=e.sent)){e.next=24;break}return e.abrupt("return",!1);case 24:e.next=17;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(15),l.e(e.t0);case 31:return e.prev=31,l.f(),e.finish(31);case 34:e.next=39;break;case 36:return e.next=38,i(s);case 38:c=e.sent;case 39:if(!1!==c){e.next=41;break}return e.abrupt("return",!1);case 41:e.next=47;break;case 43:return e.prev=43,e.t1=e.catch(8),n.failed("Couldn't apply action ".concat(JSON.stringify(s)," with error ").concat(e.t1.message)),e.abrupt("return",e.t1);case 47:e.next=6;break;case 49:e.next=54;break;case 51:e.prev=51,e.t2=e.catch(4),r.e(e.t2);case 54:return e.prev=54,r.f(),e.finish(54);case 57:e.next=61;break;case 59:return n.failed("Jquery not found on window"),e.abrupt("return",!1);case 61:case"end":return e.stop()}}),e,null,[[4,51,54,57],[8,43],[15,28,31,34]])})));return function(t){return e.apply(this,arguments)}}(),e.next=16,x(r);case 16:return _=e.sent,e.abrupt("return",_);case 18:case"end":return e.stop()}}),e)}))),ur.apply(this,arguments)}var lr=function(e){return ur.apply(this,arguments)};function pr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return dr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var fr=new C("BeagleRobotEngine"),hr={subtree:!0,childList:!0,attributes:!0},vr=function(){function e(t){i(this,e);var r=t.debugFilteredTreatments,n=t.debugMode,a=t.matchedTreatments,o=t.identifier,s=t.pageType;this.engagementLock={},this.pageType=s,this.debugMode=n,this.identifier=o,this.reApplyTreatmentsMap={},this.addedDataListenerIds=[],this.matchedTreatments=a,this.debugFilteredTreatments=r,this.isMobile=window.matchMedia(y).matches}var r,n,s,c,l,p,d;return u(e,[{key:"engageRobots",value:(d=t(a().mark((function e(){var t,r,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=pr(this.matchedTreatments),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=15;break}return n=r.value,e.prev=5,e.next=8,this.engageRobot(n);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),fr.failed("Error engaging robot ".concat(n.id,": ").concat(e.t0.message||e.t0));case 13:e.next=3;break;case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(1),t.e(e.t1);case 20:return e.prev=20,t.f(),e.finish(20);case 23:this.initiateReapplyRobotMap();case 24:case"end":return e.stop()}}),e,this,[[1,17,20,23],[5,10]])}))),function(){return d.apply(this,arguments)})},{key:"engageRobot",value:(p=t(a().mark((function e(r){var n,o,i,s,c,u,l,p,d,f,h,v,m,g,y,b,w,x,k,_,S,I,A,L,T,D,P,E,O,C,R=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.id,o=r.actions,i=r.eligibilityRuleSet,s=r.device,c=r.dependant_on_treatment,u=r.reapply_event,l=r.reapply_event_page_type,p=r.businessRuleSet,d=r.weight,f=r.delay,h=this.debugMode,v=this.debugFilteredTreatments,m=this.engagementLock,g=this.identifier,y=this.isMobile,b=this.reApplyTreatmentsMap,w=this.matchedTreatments,x=this.pageType,k=this.prepareAndApply,!m[n]){e.next=5;break}return fr.log("Treatment ".concat(n," engagement in progress, skipping")),e.abrupt("return");case 5:if(m[n]=!0,1===h||d||c){e.next=9;break}return m[n]=!1,e.abrupt("return");case 9:if(!h||!v||Object.keys(v).map((function(e){return parseInt(e,10)})).includes(n)){e.next=12;break}return m[n]=!1,e.abrupt("return");case 12:if("mobile"!==s||y){e.next=16;break}return fr.failed("Treatment device 'mobile' mismatch"),m[n]=!1,e.abrupt("return");case 16:if("desktop"!==s||!y){e.next=20;break}return fr.failed("Treatment device 'desktop' mismatch"),m[n]=!1,e.abrupt("return");case 20:if(u&&(!l||l===x)){_=u,Array.isArray(u)||(_=[u]),fr.log("Reapply event '".concat(u,"' found for treatment: ").concat(n)),S=pr(_);try{for(S.s();!(I=S.n()).done;)A=I.value,(L=b[A]?b[A]:[]).includes(n)?fr.log("Treatment already added for reapply event"):b[A]=[].concat(M(L),[n])}catch(e){S.e(e)}finally{S.f()}}if(fr.log("Starting base rule set check for treatment: "+n),e.t0=!i,e.t0){e.next=27;break}return e.next=26,this.checkEligibilityRuleSet(i);case 26:e.t0=e.sent;case 27:if(!e.t0){e.next=63;break}if(T=100===d?0:100-d||50,c&&(P=null===(D=w.find((function(e){return e.id===c})))||void 0===D?void 0:D.weight,T=100===P?0:100-P||50),fr.log("Treatment skip ratio: "+T),E=c||n,1!==h){e.next=36;break}e.t1=100,e.next=39;break;case 36:return e.next=38,ee(g+E);case 38:e.t1=e.sent;case 39:if(O=e.t1,fr.log("TreatmentPct: "+O+" with debug mode ".concat(h?"on":"off")),C=null,!p){e.next=48;break}return fr.log("Starting sub variant rule set check for treatment: "+n),e.next=46,this.checkBusinessRules(p);case 46:null!==(C=e.sent)?fr.log("Applying business rule transformation with id: ",C):fr.log("Applying treatment with default values");case 48:if(!(O<T)){e.next=53;break}return fr.log("Treatment ".concat(n," skipped due to treatment split ratio")),Qe(n,C,null,"skipped",c),m[n]=!1,e.abrupt("return");case 53:if(f){e.next=60;break}return e.next=56,k(n,g,o,C,h,v[n]);case 56:m[n]=!1,this.addRuleSetDataListeners(r),e.next=61;break;case 60:setTimeout(t(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(n,g,o,C,h,v[n]);case 2:m[n]=!1,R.addRuleSetDataListeners(r);case 4:case"end":return e.stop()}}),e)}))),f);case 61:e.next=65;break;case 63:fr.failed("Rule check failed for treatment:",n),m[r.id]=!1;case 65:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"prepareAndApply",value:(l=t(a().mark((function e(t,r,n,o,i,s){var c,u,l,p,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne(r,n,o,i,s);case 2:return c=e.sent,u=N(c,2),l=u[0],p=u[1],e.next=8,lr(l);case 8:d=e.sent,Qe(t,o,p,!1===d?"failed":"applied");case 10:case"end":return e.stop()}}),e)}))),function(e,t,r,n,a,o){return l.apply(this,arguments)})},{key:"initiateReapplyRobotMap",value:function(){for(var e=this,r=this.reApplyTreatmentsMap,n=this.matchedTreatments,o=function(){var o=s[i],c=r[o],u=n.filter((function(e){return c.includes(e.id)}));switch(o){case"infinite_scroll":var l=new ResizeObserver((function(){var t,r=pr(u);try{for(r.s();!(t=r.n()).done;){var n=t.value;fr.log("Retrying treatment ".concat(n.id," from infinite_scroll")),e.engageRobot(n)}}catch(e){r.e(e)}finally{r.f()}}));l.observe(window.top.document.documentElement);break;case"timeout":setTimeout((function(){var t,r=pr(u);try{for(r.s();!(t=r.n()).done;){var n=t.value;fr.log("Retrying treatment ".concat(n.id," from timeout")),e.engageRobot(n)}}catch(e){r.e(e)}finally{r.f()}}),500);break;case"element_change":var p,d=pr(u);try{var f=function(){var t,r=p.value,n=pr(Array.isArray(r.reapply_selector)?r.reapply_selector:[r.reapply_selector]);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=window.top.document.querySelector(a);o&&new MutationObserver((function(){fr.log("Retrying treatment ".concat(r.id," from element_change")),e.engageRobot(r)})).observe(o,hr)}}catch(e){n.e(e)}finally{n.f()}};for(d.s();!(p=d.n()).done;)f()}catch(e){d.e(e)}finally{d.f()}break;case"on_scroll":var h=0,v=0;window.addEventListener("scroll",(function(){var t=(new Date).getTime(),r=window.pageYOffset||window.top.document.documentElement.scrollTop;if(t-v>250&&Math.abs(h-r)>5){h=r,v=t;var n,a=pr(u);try{for(a.s();!(n=a.n()).done;){var o=n.value;fr.log("Retrying treatment ".concat(o.id," from on_scroll")),e.engageRobot(o)}}catch(e){a.e(e)}finally{a.f()}}}),!1);break;case"query_search_change":var m=window.location.search,g=new MutationObserver((function(){if(window.location.search!==m){m=window.location.search;var t,r=pr(u);try{for(r.s();!(t=r.n()).done;){var n=t.value;fr.log("Retrying treatment ".concat(n.id," from query_search_change")),e.engageRobot(n)}}catch(e){r.e(e)}finally{r.f()}}}));g.observe(document,hr);break;case"interval":var y,b=pr(u);try{var w=function(){var r=y.value,n=setInterval(t(a().mark((function t(){var o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Be("a",!0);case 2:if(null==(o=t.sent)||!o[r.id]){t.next=7;break}clearInterval(n),t.next=10;break;case 7:return fr.log("Retrying treatment ".concat(r.id," from interval")),t.next=10,e.engageRobot(r);case 10:case"end":return t.stop()}}),t)}))),50);setTimeout((function(){clearInterval(n)}),2500)};for(b.s();!(y=b.n()).done;)w()}catch(e){b.e(e)}finally{b.f()}break;case"info_layer_change":var x,k=pr(u);try{for(k.s();!(x=k.n()).done;){var _=x.value,S=e.engageRobot.bind(e,_);Ne(_.reapply_selector,S)}}catch(e){k.e(e)}finally{k.f()}break;default:fr.failed("Reapply event not found: ",o)}},i=0,s=Object.keys(r);i<s.length;i++)o()}},{key:"addRuleSetDataListeners",value:(c=t(a().mark((function e(t){var r,n,o,i,s,c,u,l,p,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.eligibilityRuleSet,n=void 0===r?[]:r,o=t.businessRuleSet,i=void 0===o?[]:o,s=t.id,!this.addedDataListenerIds.includes(s)){e.next=3;break}return e.abrupt("return");case 3:c=this.extractDataListenerSelectors([].concat(M(n),M(i))),u=this.engageRobot.bind(this,t),l=pr(c);try{for(l.s();!(p=l.n()).done;)d=p.value,Ne("__eRules.".concat(d),u)}catch(e){l.e(e)}finally{l.f()}this.addedDataListenerIds.push(s);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"extractDataListenerSelectors",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=r||[],a=pr(e);try{for(a.s();!(t=a.n()).done;){var o=t.value;"string"!=typeof o?this.extractDataListenerSelectors(o.set,n):(o.startsWith("!")&&(o=o.slice(1)),n.push(o.split(".")[0]))}}catch(e){a.e(e)}finally{a.f()}return M(new Set(n))}},{key:"checkEligibility",value:(s=t(a().mark((function e(t){var r,n,o,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return fr.log("Checking eligibility ".concat(t)),r=!1,n=t.split("."),o=N(n,2),i=o[0],s=o[1],i.startsWith("!")&&(r=!0,i=i.slice(1)),e.next=6,Be("__eRules.".concat(i));case 6:if((c=e.sent)&&Array.isArray(c)){e.next=9;break}return e.abrupt("return",!1);case 9:if(!r||!c.includes(s)){e.next=11;break}return e.abrupt("return",!1);case 11:if(r||c.includes(s)){e.next=13;break}return e.abrupt("return",!1);case 13:return fr.log("".concat(t," is eligible")),e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e)}))),function(e){return s.apply(this,arguments)})},{key:"checkEligibilityRuleSet",value:(n=t(a().mark((function e(t){var r,n,i,s,c,u,l=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=l.length>1&&void 0!==l[1]?l[1]:null,n=l.length>2&&void 0!==l[2]?l[2]:null,fr.log("Checking robot eligibility"),Array.isArray(t)){e.next=6;break}return fr.failed("Eligibility Rule Set ".concat(t," is not an array")),e.abrupt("return",!1);case 6:i=n,s=pr(t),e.prev=8,s.s();case 10:if((c=s.n()).done){e.next=57;break}if("string"!=typeof(u=c.value)){e.next=49;break}if(r){e.next=21;break}return e.next=16,this.checkEligibility(u);case 16:if(i=e.sent){e.next=19;break}return e.abrupt("return",!1);case 19:e.next=47;break;case 21:if(!r){e.next=47;break}if(null!==i){e.next=27;break}return e.next=25,this.checkEligibility(u);case 25:return i=e.sent,e.abrupt("continue",55);case 27:e.t0=r,e.next="or"===e.t0?30:"and"===e.t0?37:44;break;case 30:if(e.t1=i,e.t1){e.next=35;break}return e.next=34,this.checkEligibility(u,r);case 34:e.t1=e.sent;case 35:return i=e.t1,e.abrupt("break",47);case 37:if(e.t2=i,!e.t2){e.next=42;break}return e.next=41,this.checkEligibility(u,r);case 41:e.t2=e.sent;case 42:return i=e.t2,e.abrupt("break",47);case 44:return fr.failed("Unknown eligibilitySetType: ",r),i=!1,e.abrupt("break",47);case 47:e.next=55;break;case 49:if("object"!==o(u)){e.next=55;break}return e.next=52,this.checkEligibilityRuleSet(u.set,u.type,i);case 52:if(i=e.sent){e.next=55;break}return e.abrupt("return",!1);case 55:e.next=10;break;case 57:e.next=62;break;case 59:e.prev=59,e.t3=e.catch(8),s.e(e.t3);case 62:return e.prev=62,s.f(),e.finish(62);case 65:return e.abrupt("return",i);case 66:case"end":return e.stop()}}),e,this,[[8,59,62,65]])}))),function(e){return n.apply(this,arguments)})},{key:"checkBusinessRules",value:(r=t(a().mark((function e(t){var r,n,o,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=pr(t.entries()),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=11;break}return o=N(n.value,2),i=o[0],s=o[1],e.next=7,this.checkEligibilityRuleSet([s]);case 7:if(!e.sent){e.next=9;break}return e.abrupt("return",i);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:return e.abrupt("return",null);case 20:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))),function(e){return r.apply(this,arguments)})}]),e}(),mr=new C("BeagleOnComponent"),gr=function(){var e=t(a().mark((function e(t,r,n){var o,i,s,c,u,l,p,d,f,h,v,m,g,y;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Tt.getInstance().persistProductInfo(),i=yr(),s=zt.getTreatments(),c=zt.getTreatmentWeights(),re(),void 0,void 0,void 0,void 0,void 0,void 0,a=k,b=w,_=x,S=sessionStorage.getItem(a),I=sessionStorage.getItem(b),A=sessionStorage.getItem(_),null===S&&sessionStorage.setItem(a,0),I||sessionStorage.setItem(b,Date.now()),A?sessionStorage.setItem(_,[window.location.pathname,A]):sessionStorage.setItem(_,[window.location.pathname]),Re("m","on-init"),u=window.location.search,l=null,r&&u.includes("filter=")&&(l=u.slice(u.indexOf("[")+1,u.lastIndexOf("]")).split(",").reduce((function(e,t){var r=t.split(":");return e[r[0]]=r[1]||null,e}),{})),e.next=12,Promise.all([s,c]);case 12:if(p=e.sent,d=N(p,2),f=d[0],h=d[1],f&&h){e.next=22;break}throw v="",f||(v+="no-robots"),h||(v=""===v?"no-robot-weights":" - no-robot-weights"),Re("m",v),new Error("Failed to fetch treatments/weights");case 22:return mr.success("Found treatments: ",f),Re("m","fetched-treatments"),m=new zt({treatments:f,treatmentWeights:h}),e.next=27,m.getMatchedTreatments();case 27:if(null!==(g=e.sent)){e.next=32;break}return Re("m","no-user-segment"),W(),e.abrupt("return");case 32:if(g.length){e.next=37;break}return mr.log("No treatments matched, returning without further action"),Re("m","no-robot-matched"),W(),e.abrupt("return");case 37:return Re("m","found-matched-robots"),e.prev=38,e.next=41,i;case 41:e.next=47;break;case 43:throw e.prev=43,e.t0=e.catch(38),Re("m","no-rules-assessed"),new Error("Could not asses eligibility rules");case 47:return Re("m","rules-assessed"),e.prev=48,e.next=51,o;case 51:e.next=57;break;case 53:throw e.prev=53,e.t1=e.catch(48),Re("m","product-into-no-persist"),new Error("Could not persist product info");case 57:return Re("m","engaging-robots"),y=new vr({debugFilteredTreatments:l,debugMode:r,matchedTreatments:g,identifier:t,pageType:n}),e.next=61,y.engageRobots();case 61:return W(),Re("m","robots-engaged"),e.t2=mr,e.next=66,Be("a");case 66:e.t3=e.sent,e.t2.success.call(e.t2,"Applied treatments: ",e.t3);case 68:case"end":return e.stop()}var a,b,_,S,I,A}),e,null,[[38,43],[48,53]])})));return function(t,r,n){return e.apply(this,arguments)}}();function yr(){return br.apply(this,arguments)}function br(){return(br=t(a().mark((function e(){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Re("m","fetching-eligibility-rules"),e.next=3,Qt.getEligibilityRules();case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return");case 6:return Re("m","fetched-eligibility-rules"),r=new Qt({eligibilityRules:t}),e.next=10,r.assesEligibilityRules();case 10:Re("m","assessed-eligibility-rules");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var wr=gr,xr=!1;t(a().mark((function e(){var t,r,n,o,i,s,c,u,l,p,d,f,h,v,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(),t=null,(r=new C).info("Beagle initializing"),window.dataLayer=window.dataLayer||[],n=!1,o=!1,e.prev=7,Re("GLOV_ON","not-sent | initializing"),t=new nt,Ve(),e.next=13,ce();case 13:return s=e.sent,r.log("Found identifier: ",s),Re("cookieGaId",s),e.next=18,ee(s);case 18:return c=e.sent,Re("onHashPct",c),Re("view_epoch",Date.now()+Math.random()),Re("v","0.0.39.31"),Re("sr",50),e.next=25,t.packAndQueueArrivalLog();case 25:if(setTimeout((function(){W()}),2e3),u=window.localStorage.getItem(T),null!==c&&navigator.sendBeacon&&"function"==typeof navigator.sendBeacon&&"function"==typeof(null==String||null===(i=String.prototype)||void 0===i?void 0:i.padStart)&&(!u||"unsupported"!==u)){e.next=32;break}throw window.dataLayer.push({event:"GLOV",GLOV_ON:"unsupported"}),window.localStorage.setItem(T,"unsupported"),Re("GLOV_ON","unsupported | device"),new Error("unsupported-device");case 32:if(l=window.localStorage.getItem(D),p=parseInt(sessionStorage.getItem(_))||0,(d=oe("employee"))||u||l||!(p>1)){e.next=39;break}throw window.dataLayer.push({event:"GLOV",GLOV_ON:"unsupported"}),Re("GLOV_ON","unsupported | timeout"),new Error("max-timeout");case 39:if(f=function(){throw window.dataLayer.push({event:"GLOV",GLOV_ON:"employee"}),window.localStorage.setItem(T,"employee"),window.localStorage.setItem(E,!0),Re("GLOV_ON","employee | admin"),new Error("admin-employee")},null!=(h=window.localStorage.getItem(E))){e.next=47;break}return e.next=44,Be("vvsIsShowroom",!0);case 44:h=e.sent,e.next=48;break;case 47:"false"!==h&&!1!==h||Be("vvsIsShowroom",!0).then((function(e){!e||"true"!==e&&!0!==e||f()}));case 48:if(!h||"true"!==h&&!0!==h){e.next=52;break}f(),e.next=59;break;case 52:if(null!=h){e.next=58;break}throw sessionStorage.setItem(_,p+1),Re("GLOV_ON","not-sent | timeout"),new Error("no-admin-status");case 58:window.localStorage.setItem(E,!1);case 59:if(window.top.document.documentElement.classList.contains("glov-ease")){e.next=63;break}throw sessionStorage.setItem(_,p+1),Re("GLOV_ON","not-sent | timeout"),new Error("anti-flicker-timeout");case 63:if(v=null,!d){e.next=71;break}r.log("Debug mode on: all applicable treatments will be applied"),v=!0,window.dataLayer.push({event:"GLOV",GLOV_ON:"employee"}),Re("GLOV_ON","employee | tester"),e.next=87;break;case 71:if(!u||"employee"!==u){e.next=78;break}r.warn("User is out of scope"),v=c>=50,window.dataLayer.push({event:"GLOV",GLOV_ON:"employee"}),Re("GLOV_ON","employee | tester"),e.next=87;break;case 78:if(!u){e.next=83;break}throw Re("GLOV_ON","not-sent | unknown"),new Error("Unknown out of scope reason");case 83:c>=50?(v=!0,window.dataLayer.push({event:"GLOV",GLOV_ON:"true"})):c>=25?(v=!1,window.dataLayer.push({event:"GLOV",GLOV_ON:"false2"})):(v=!1,window.dataLayer.push({event:"GLOV",GLOV_ON:"false1"})),Re("isOn",v),window.localStorage.setItem(D,!0),Re("GLOV_ON",v.toString());case 87:return e.next=89,Be("PageType",!0);case 89:if("purchase"!==(m=e.sent)){e.next=100;break}return e.next=93,Be("purchase.revenue",!0,50,5e3);case 93:return e.next=95,Be("purchase.paymentType",!0,50,5e3);case 95:return e.next=97,t.sendLogs(!0);case 97:xr=!0,e.next=101;break;case 100:t.sendLogs(!1);case 101:if(n=!0,!0!==v){e.next=106;break}xr?(r.info("Beagle ON Group SHUTDOWN Path"),W(),o=!0):(r.log("Beagle ON Group Path"),wr(s,d,m)),e.next=113;break;case 106:if(!1!==v){e.next=112;break}r.info("Beagle OFF Group Path"),W(),o=!0,e.next=113;break;case 112:throw new Error("isOn is undefined or null");case 113:e.next=121;break;case 115:e.prev=115,e.t0=e.catch(7),r.warn("Beagle Early Scope-out or ERROR: ",e.t0.message),Re("m",e.t0.message),!n&&t&&t.sendLogs(!1),o||W();case 121:case"end":return e.stop()}}),e,null,[[7,115]])})))()}()}();
